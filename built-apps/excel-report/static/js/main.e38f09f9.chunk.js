(this["webpackJsonpexcel-report"]=this["webpackJsonpexcel-report"]||[]).push([[0],{140:function(e,t,a){e.exports={"charts-container":"chart_charts-container__3aKXI","modal-charts-container":"chart_modal-charts-container__31SLT"}},316:function(e,t){},339:function(e,t,a){e.exports={"process-wrapper":"style_process-wrapper__1SYOD"}},340:function(e,t,a){e.exports={"loading-wrapper":"style_loading-wrapper__15QEM"}},373:function(e,t,a){},437:function(e,t){},438:function(e,t){},563:function(e,t,a){"use strict";a.r(t);a(366);var n=a(29),r=a(7),s=a(0),i=a.n(s),l=a(57),o=a.n(l),c=(a(373),a(374),a(342)),u=a(74),d=(a(226),a(117)),h=(a(200),a(81)),p=(a(314),a(177)),b=(a(163),a(58)),m=a(361),f=(a(108),a(30)),j=a(178),_=a(60),v=a(87),O=a(242),x=a(243),y=a(273),g=a(268),C=(a(431),a(299)),w=a(99),N="toggle-progress",k="set-percent",D="toggle-loading",S=N,P=k,E=D,I=function(e){return{type:N,payload:{show:e}}},M=function(e){return{type:k,payload:{percent:e}}},A=function(e){return{type:D,payload:{loading:e}}},T=a(72),F=a.n(T),L=a(343),R=(a(540),a(197)),B=(a(564),a(219)),H=a(274),z=a(90),K=a(34),U=a(207),W=(a(225),a(105)),G=[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",titleName:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:80,fixed:"left"},{title:"\u57f9\u8bad\u9879\u76ee\u6570",titleName:"\u57f9\u8bad\u9879\u76ee\u6570",key:"trainProjectCount",dataIndex:"trainProjectCount",ellipsis:!0,width:100},{title:"\u57f9\u8bad\u603b\u4eba\u6b21",titleName:"\u57f9\u8bad\u603b\u4eba\u6b21",key:"trainPersonCount",dataIndex:"trainPersonCount",ellipsis:!0,width:100},{title:"\u7406\u8bba\u57f9\u8bad\u8bfe\u65f6",titleName:"\u7406\u8bba\u57f9\u8bad\u8bfe\u65f6",key:"theoryHours",dataIndex:"theoryHours",ellipsis:!0,width:100},{title:"\u5b9e\u64cd\u57f9\u8bad\u8bfe\u65f6",titleName:"\u5b9e\u64cd\u57f9\u8bad\u8bfe\u65f6",key:"practiceHours",dataIndex:"practiceHours",ellipsis:!0,width:100}];function J(e){return[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",titleName:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:60,fixed:"left"},{title:"\u57f9\u8bad\u5e08\u4eba\u6570",titleName:"\u57f9\u8bad\u5e08\u4eba\u6570",key:"personCount",dataIndex:"personCount",ellipsis:!0,width:100,render:function(t,a,n){return Object(r.jsx)(W.a,{type:"number",size:"small",min:0,step:1,value:a.personCount,onChange:function(t){var a=+t.target.value,r=Object(v.a)(e.state.tableDataC);r[n].personCount=a,r[n].rate=a?r[n].personCourseCount/a:void 0,r.forEach((function(e,t){})),e.setState({tableDataC:r})}})}},{title:"\u57f9\u8bad\u5e08\u6388\u8bfe\u4eba\u6570",titleName:"\u57f9\u8bad\u5e08\u6388\u8bfe\u4eba\u6570",key:"personCourseCount",dataIndex:"personCourseCount",ellipsis:!0,width:100},{title:"\u57f9\u8bad\u5e08\u5229\u7528\u7387",titleName:"\u57f9\u8bad\u5e08\u5229\u7528\u7387",key:"rate",dataIndex:"rate",ellipsis:!0,width:100},{title:"\u603b\u6388\u8bfe\u5b66\u65f6",titleName:"\u603b\u6388\u8bfe\u5b66\u65f6",key:"totalHours",dataIndex:"totalHours",ellipsis:!0,width:100},{title:"\u4eba\u5747\u6388\u8bfe\u5b66\u65f6",titleName:"\u4eba\u5747\u6388\u8bfe\u5b66\u65f6",key:"averHours",dataIndex:"averHours",ellipsis:!0,width:100}]}var q=[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",titleName:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:80,fixed:"left"},{title:"\u8bc4\u4f30\u9879\u76ee\u6570",titleName:"\u8bc4\u4f30\u9879\u76ee\u6570",key:"projectCount",dataIndex:"projectCount",ellipsis:!0,width:100},{title:"\u8bc4\u4f30\u4eba\u6b21",titleName:"\u8bc4\u4f30\u4eba\u6b21",key:"assessCount",dataIndex:"assessCount",ellipsis:!0,width:100},{title:"\u5408\u683c\u7387",titleName:"\u5408\u683c\u7387",key:"passedRate",dataIndex:"passedRate",ellipsis:!0,width:100},{title:"\u901a\u8fc7\u4eba\u6b21",titleName:"\u901a\u8fc7\u4eba\u6b21",key:"passedCount",dataIndex:"passedCount",ellipsis:!0,width:100},{title:"\u672a\u901a\u8fc7\u4eba\u6b21",titleName:"\u672a\u901a\u8fc7\u4eba\u6b21",key:"failedCount",dataIndex:"failedCount",ellipsis:!0,width:100},{title:"\u7406\u8bba\u9a8c\u6536\u4eba\u6b21",titleName:"\u7406\u8bba\u9a8c\u6536\u4eba\u6b21",key:"theoryCount",dataIndex:"theoryCount",ellipsis:!0,width:100},{title:"\u5b9e\u64cd\u9a8c\u6536\u4eba\u6b21",titleName:"\u5b9e\u64cd\u9a8c\u6536\u4eba\u6b21",key:"trainCount",dataIndex:"trainCount",ellipsis:!0,width:100}],Y=a(140),V=a.n(Y),X=a(112),Z=a(333),Q=a(577),$=a(574),ee=a(570),te=a(571),ae=a(573),ne=a(576),re=a(575),se=a(572),ie=a(578);X.a([ee.a,te.a,ae.a,ne.a,re.a,se.a,Q.a,$.a,ie.a]);var le,oe,ce=function(e){var t=Object(s.useRef)(null);return Object(s.useEffect)((function(){var a,n;if(t.current){var r=Z.init(t.current,{},{width:800,height:350}),s=e.markLine?[{type:"line",markLine:{silent:!0,data:[{name:"\u8fbe\u6807\u7ebf",yAxis:null!==(a=e.markLine)&&void 0!==a?a:0}],label:{},lineStyle:{width:2}}}]:[],i={title:{text:null!==(n=e.title)&&void 0!==n?n:"\u8868",textAlign:"center",left:"50%"},legend:{top:30,formatter:function(t){var a,n;return null!==(a=null===(n=e.dimensions.find((function(e){return e.key===t})))||void 0===n?void 0:n.label)&&void 0!==a?a:""}},grid:{top:80,bottom:30},xAxis:{type:"category"},yAxis:{type:"value"},dataset:{dimensions:e.dimensions.map((function(e){return e.key})),source:e.data},series:[].concat(Object(v.a)(Array(e.dimensions.length-1).fill({type:"line",label:{show:!0,position:"top",fontSize:10,formatter:function(e){return e.value[e.seriesName]?(+e.value[e.seriesName]).toFixed(2):""}}})),s)};return r.setOption(i),function(){r.dispose()}}}),[e.data]),Object(r.jsx)("div",{className:V.a["charts-container"],children:Object(r.jsx)("canvas",{className:V.a.chart,ref:t})})},ue=a(93),de=function(e){Object(y.a)(a,e);var t=Object(g.a)(a);function a(e){var n,s;return Object(O.a)(this,a),(n=t.call(this,e)).idCount=Date.now(),n.handleCalcPatr1=function(){var e=new Set;n.props.outerData.forEach((function(t){return e.add(t[n.state.filters.table1])}));var t,a=[],r=Object(_.a)(e.values());try{for(r.s();!(t=r.n()).done;){var s=t.value;a.push({label:s,value:s})}}catch(c){r.e(c)}finally{r.f()}var i=[],l=[],o=[];[{value:void 0}].concat(a).forEach((function(e){var t=e.value,a=n.calcDataA(t),r=n.calcDataB(t),s=n.calcDataC(t);i.push.apply(i,Object(v.a)(a)),l.push.apply(l,Object(v.a)(r)),o.push.apply(o,Object(v.a)(s))})),n.setState({tableDataA:[].concat(i),tableDataB:[].concat(l),tableDataC:[].concat(o)})},n.handleCalcPatr2=function(){var e=new Set;n.props.outerData.forEach((function(t){return e.add(t[n.state.filters.table2])}));var t,a=[],r=Object(_.a)(e.values());try{for(r.s();!(t=r.n()).done;){var s=t.value;a.push({label:s,value:s})}}catch(l){r.e(l)}finally{r.f()}var i=[];[{value:void 0}].concat(a).forEach((function(e){var t=e.value,a=n.calcDataD(t);i.push.apply(i,Object(v.a)(a))})),n.setState({tableDataD:[].concat(i)})},n.handleExportPart1=function(e){var t=null!==e&&void 0!==e?e:F.a.utils.book_new(),a=Object(ue.b)(n.state.tableColumnsA,n.state.tableDataA);F.a.utils.book_append_sheet(t,a,"\u6838\u5fc3\u6280\u80fd\u60c5\u51b5\u8868");var r=Object(ue.b)(n.state.tableColumnsB,n.state.tableDataB);F.a.utils.book_append_sheet(t,r,"\u57f9\u8bad\u57fa\u672c\u60c5\u51b5\u8868");var s=Object(ue.b)(n.state.tableColumnsC,n.state.tableDataC);F.a.utils.book_append_sheet(t,s,"\u57f9\u8bad\u5e08\u60c5\u51b5\u8868"),!e&&F.a.writeFile(t,"\u57f9\u8bad\u60c5\u51b5\u5206\u6790\u7ed3\u679c.xlsx")},n.state={tableDataA:[],tableColumnsA:G,tableDataB:[],tableColumnsB:(s=Object(U.a)(n),[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u5c97\u4f4d",titleName:"\u5c97\u4f4d",key:"station",dataIndex:"station",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",titleName:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:60,fixed:"left"},{title:"\u73b0\u5458\u4eba\u6570",titleName:"\u73b0\u5458\u4eba\u6570",key:"nowPersonCount",dataIndex:"nowPersonCount",ellipsis:!0,width:120,fixed:"left",render:function(e,t,a){return Object(r.jsx)(W.a,{type:"number",size:"small",min:0,step:1,value:t.nowPersonCount,onChange:function(e){var t=+e.target.value,n=Object(v.a)(s.state.tableDataB);n[a].nowPersonCount=t,n[a].averTrainHours=t?n[a].trainHours/t:void 0;var r=n.filter((function(e){return e.type===n[a].type&&e.unitName===n[a].unitName})),i="M"===n[a].type?42:"P"===n[a].type?60:1;r.forEach((function(e,t){var a,r,s,l;e.yearAverHours=0===t?null!==(r=e.averTrainHours)&&void 0!==r?r:0:(null!==(s=e.averTrainHours)&&void 0!==s?s:0)+(null!==(l=n[t-1].yearAverHours)&&void 0!==l?l:0),e.completeRate=(null!==(a=e.yearAverHours)&&void 0!==a?a:0)/i})),s.setState({tableDataB:n})}})}},{title:"\u57f9\u8bad\u8bfe\u65f6",titleName:"\u57f9\u8bad\u8bfe\u65f6",key:"trainHours",dataIndex:"trainHours",ellipsis:!0,width:80},{title:"\u57f9\u8bad\u6761\u6570",titleName:"\u57f9\u8bad\u6761\u6570",key:"trainCount",dataIndex:"trainCount",ellipsis:!0,width:80},{title:"\u57f9\u8bad\u4eba\u6b21",titleName:"\u57f9\u8bad\u4eba\u6b21",key:"trainPersonCount",dataIndex:"trainPersonCount",ellipsis:!0,width:80},{title:"\u4eba\u5747\u57f9\u8bad\u8bfe\u65f6\uff08\u5c0f\u65f6\uff09",titleName:"\u4eba\u5747\u57f9\u8bad\u8bfe\u65f6\uff08\u5c0f\u65f6\uff09",key:"averTrainHours",dataIndex:"averTrainHours",ellipsis:!0,width:120},{title:"\u5e74\u5ea6\u7d2f\u8ba1\u4eba\u5747\u8bfe\u65f6\uff08\u5c0f\u65f6\uff09",titleName:"\u5e74\u5ea6\u7d2f\u8ba1\u4eba\u5747\u8bfe\u65f6\uff08\u5c0f\u65f6\uff09",key:"yearAverHours",dataIndex:"yearAverHours",ellipsis:!0,width:120},{title:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387",titleName:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387",key:"completeRate",dataIndex:"completeRate",ellipsis:!0,width:120}]),tableDataC:[],tableColumnsC:J(Object(U.a)(n)),tableDataD:[],tableColumnsD:q,selectedColumnsMap:{month:"B",project:"H",role:"V",manage:"Y",product:"AA",hours:"AG",totalPersonCount:"AD",theoryHours:"AE",practiceHours:"AF",unitName:"F"},filters:{table1:"G",table2:"H"}},n}return Object(x.a)(a,[{key:"calcDataA",value:function(e){var t=this.state.selectedColumnsMap,a=new Map;this.props.outerData.forEach((function(n){if("\u57f9\u8bad\u5e08"===n[t.role]&&"\u5fc5\u77e5\u5fc5\u4f1a\u57f9\u8bad"===n[t.project]&&(!e||n.G===e)){var r=new Date(n[t.month]).getMonth()+1;if(a.has(r)){var s,i=a.get(r);if(i)i.trainProjectCount+=1,i.trainPersonCount+=+n[t.totalPersonCount],i.theoryHours+=+n[t.theoryHours],i.practiceHours+=+n[t.practiceHours],null===(s=i.remarks)||void 0===s||s.add(n.J)}else a.set(r,{trainProjectCount:1,trainPersonCount:+n[t.totalPersonCount],theoryHours:+n[t.theoryHours],practiceHours:+n[t.practiceHours],unitName:e||n[t.unitName],remarks:new Set([n.J]),isCondition:!!e})}}));var n,r=[],s=Object(_.a)(a.entries());try{for(s.s();!(n=s.n()).done;){var i,l=Object(K.a)(n.value,2),o=l[0],c=l[1];r.push(Object(z.a)(Object(z.a)({id:(this.idCount++).toString()},c),{},{month:o,monthName:o+"\u6708",remarksText:Array.from(null!==(i=c.remarks)&&void 0!==i?i:[]).join("\u3001")}))}}catch(u){s.e(u)}finally{s.f()}return r.sort((function(e,t){return e.month-t.month})),!e&&this.setState({tableDataA:r}),r}},{key:"calcDataB",value:function(e){var t=this.state.selectedColumnsMap,a=new Map;this.props.outerData.forEach((function(n){if("\u57f9\u8bad\u5e08"===n[t.role]&&(!e||n.G===e)){var r=new Date(n[t.month]).getMonth()+1,s=+n[t.manage],i=+n[t.product];if(s>0){var l=r+"M";if(a.has(l)){var o=a.get(l);o&&(o.trainCount+=1,o.trainHours+=s*+n[t.hours],o.trainPersonCount+=s)}else a.set(l,{type:"M",station:"\u7ba1\u7406\u548c\u4e1a\u52a1\u6280\u672f",month:r,trainCount:1,trainHours:s*+n[t.hours],trainPersonCount:s,unitName:e||n[t.unitName],isCondition:!!e})}if(i>0){var c=r+"P";if(a.has(c)){var u=a.get(c);u&&(u.trainCount+=1,u.trainHours+=i*+n[t.hours],u.trainPersonCount+=i)}else a.set(c,{type:"P",station:"\u751f\u4ea7\u4eba\u5458",month:r,trainCount:1,trainHours:i*+n[t.hours],trainPersonCount:i,unitName:e||n[t.unitName],isCondition:!!e})}}}));var n,r=[],s=Object(_.a)(a.entries());try{for(s.s();!(n=s.n()).done;){var i=Object(K.a)(n.value,2),l=(i[0],i[1]);r.push(Object(z.a)(Object(z.a)({id:(this.idCount++).toString()},l),{},{monthName:l.month+"\u6708",nowPersonCount:"P"===l.type?122:"M"===l.type?19:void 0}))}}catch(u){s.e(u)}finally{s.f()}r.sort((function(e,t){var a=e.type.charCodeAt(0)-t.type.charCodeAt(0);return 0===a?e.month-t.month:a}));var o=function(e){var t,a=null!==(t=r[e].nowPersonCount)&&void 0!==t?t:0,n=r;n[e].averTrainHours=a?n[e].trainHours/a:void 0;var s=n.filter((function(t){return t.type===n[e].type&&t.unitName===n[e].unitName})),i="M"===n[e].type?42:"P"===n[e].type?60:1;s.forEach((function(e,t){var a,r,s,l;0===t?e.yearAverHours=null!==(r=e.averTrainHours)&&void 0!==r?r:0:e.yearAverHours=(null!==(s=e.averTrainHours)&&void 0!==s?s:0)+(null!==(l=n[t-1].yearAverHours)&&void 0!==l?l:0);e.completeRate=(null!==(a=e.yearAverHours)&&void 0!==a?a:0)/i}))};for(var c in r)o(c);return!e&&this.setState({tableDataB:r}),r}},{key:"calcDataC",value:function(e){var t=this.state.selectedColumnsMap,a=new Map,n=new Set(["\u89c1\u4e60","\u4e00\u661f","\u4e8c\u661f","\u4e09\u661f","\u56db\u661f","\u4e94\u661f"]),r=new Set;this.props.outerData.forEach((function(s){if(n.has(s.W)&&(!e||s.G===e)){var i=new Date(s[t.month]).getMonth()+1,l=(s.T+i).toString();if(r.has(l)){if(a.has(i)){var o=a.get(i);o&&(o.totalHours+=+s[t.hours])}}else if(r.add(l),a.has(i)){var c=a.get(i);c&&(c.personCourseCount+=1,c.totalHours+=+s[t.hours])}else a.set(i,{unitName:e||s[t.unitName],personCourseCount:1,totalHours:+s[t.hours],isCondition:!!e})}}));var s,i=[],l=Object(_.a)(a.entries());try{for(l.s();!(s=l.n()).done;){var o=Object(K.a)(s.value,2),c=o[0],u=o[1];i.push(Object(z.a)(Object(z.a)({id:(this.idCount++).toString()},u),{},{month:+c,averHours:u.totalHours/u.personCourseCount,monthName:c+"\u6708",personCount:7,rate:u.personCourseCount/7}))}}catch(d){l.e(d)}finally{l.f()}return i.sort((function(e,t){return e.month-t.month})),!e&&this.setState({tableDataC:i}),i}},{key:"calcDataD",value:function(e){this.state.selectedColumnsMap;var t=new Map,a=new Set(["\u3010\u6240\u6709\u4e13\u4e1a\u3011\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u5b89\u5168\u7ea2\u7ebf","\u3010\u6240\u6709\u4e13\u4e1a\u3011\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u5e94\u6025\u5904\u7f6e\u7c7b\u901a\u7528\u77e5\u8bc6","\u3010\u7ad9\u53f0\u95e8\u3011\u57fa\u7840\u77e5\u8bc6","\u3010\u7ad9\u53f0\u95e8\u3011\u5b89\u5168\u56de\u8def\u5f02\u5e38\u4e2d\u65ad","\u3010\u7ad9\u53f0\u95e8\u3011\u4fe1\u53f7\u7cfb\u7edf\u65e0\u6cd5\u63a7\u5236\u5c4f\u853d\u95e8\u8054\u52a8\u5f00\u5173","\u3010\u7ad9\u53f0\u95e8\u3011\u6574\u4fa7\u6ed1\u52a8\u95e8\u591a\u7ea7\u65e0\u6cd5\u5f00\u5173","\u3010\u7efc\u5408\u76d1\u63a7\u3011\u57fa\u7840\u77e5\u8bc6","\u3010\u7efc\u5408\u76d1\u63a7\u3011\u7f51\u7edc\u4e2d\u65ad","\u3010\u6d88\u9632\u3011FAS\u4e3b\u673a\u53ca\u5de5\u4f5c\u7ad9","\u3010\u6d88\u9632\u3011\u6c14\u706d","\u3010\u6d88\u9632\u3011\u6c34\u6d88\u9632","\u3010\u6d88\u9632\u3011\u8d77\u706b\u5192\u70df\u3001FAS\u8054\u52a8\u6545\u969c","\u3010\u6d88\u9632\u3011\u533a\u95f4\u3001\u8f66\u7ad9\u6d88\u9632\u7206\u7ba1","\u3010\u6d88\u9632\u3011\u6c14\u706d\u8bef\u55b7","\u3010\u7535\u68af\u3011\u57fa\u7840\u77e5\u8bc6","\u3010\u7535\u68af\u3011\u4e58\u5ba2\u7535\u68af\u56f0\u4eba","\u3010\u7ed9\u6392\u6c34\u3011\u63a7\u5236\u67dc","\u3010\u7ed9\u6392\u6c34\u3011\u6c34\u6cf5","\u3010\u7ed9\u6392\u6c34\u3011\u9632\u6c5b\u5e94\u6025\u8bbe\u5907","\u3010\u7ed9\u6392\u6c34\u3011\u533a\u95f4\u79ef\u6c34","\u3010\u901a\u98ce\u3011\u901a\u98ce\u57fa\u7840\u77e5\u8bc6","\u3010\u901a\u98ce\u3011\u533a\u95f4\u51b7\u5a92\u6c34\u7ba1\u7206\u7ba1","\u3010\u901a\u98ce\u3011\u6d88\u9632\u7cfb\u7edf\u8054\u52a8\u4e2d\u73af\u63a7\u6a21\u5f0f\u65e0\u6cd5\u81ea\u52a8\u6267\u884c","\u3010\u4f4e\u538b\u3011400V\u4f4e\u538b\u5f00\u5173\u67dc","\u3010\u4f4e\u538b\u3011\u667a\u80fd\u7167\u660e\u6a21\u5757","\u3010\u4f4e\u538b\u3011400V\u5355\u6bb5\u5931\u7535\u6bcd\u8054\u672a\u5907\u81ea\u6295","\u3010\u4f4e\u538b\u3011\u7167\u660e\u5927\u9762\u79ef\u5931\u7535","\u3010AFC\u3011\u57fa\u672c\u77e5\u8bc6","\u3010AFC\u3011\u5168\u7ad9\u95f8\u673a\u7d27\u6025\u91ca\u653e"]),n=new Set;this.props.outerData.forEach((function(r){if(a.has(r.K)&&r.J&&(!e||r.H===e)){var s=new Date(r.J).getMonth()+1,i=(r.K+s).toString();if(n.has(i)){if(t.has(s)){var l,o=t.get(s);if(o)o.assessCount+=r.O?1:0,o.passedCount+="\u901a\u8fc7"===r.O?1:0,o.failedCount+="\u4e0d\u901a\u8fc7"===r.O?1:0,o.theoryCount+="\u7406\u8bba"===r.M&&r.O?1:0,o.trainCount+="\u5b9e\u64cd"===r.M&&r.O?1:0,null===(l=o.remarks)||void 0===l||l.add(r.K)}}else if(n.add(i),t.has(s)){var c,u=t.get(s);if(u)u.projectCount+=1,u.assessCount+=r.O?1:0,u.passedCount+="\u901a\u8fc7"===r.O?1:0,u.failedCount+="\u4e0d\u901a\u8fc7"===r.O?1:0,u.theoryCount+="\u7406\u8bba"===r.M&&r.O?1:0,u.trainCount+="\u5b9e\u64cd"===r.M&&r.O?1:0,null===(c=u.remarks)||void 0===c||c.add(r.K)}else t.set(s,{unitName:e||r.G,projectCount:1,assessCount:r.O?1:0,passedCount:"\u901a\u8fc7"===r.O?1:0,failedCount:"\u4e0d\u901a\u8fc7"===r.O?1:0,theoryCount:"\u7406\u8bba"===r.M&&r.O?1:0,trainCount:"\u5b9e\u64cd"===r.M&&r.O?1:0,remarks:new Set([r.K]),isCondition:!!e})}}));var r,s=[],i=Object(_.a)(t.entries());try{for(i.s();!(r=i.n()).done;){var l=Object(K.a)(r.value,2),o=l[0],c=l[1],u=[];if(c.remarks){var d,h=Object(_.a)(c.remarks.values());try{for(h.s();!(d=h.n()).done;){var p=d.value;u.push(p.replace(/\u3010.*\u3011/,""))}}catch(b){h.e(b)}finally{h.f()}}s.push(Object(z.a)(Object(z.a)({id:(this.idCount++).toString()},c),{},{month:+o,monthName:o+"\u6708",passedRate:c.assessCount?c.passedCount/c.assessCount:void 0,remarksText:u.join("\u3001")}))}}catch(b){i.e(b)}finally{i.f()}return s.sort((function(e,t){return e.month-t.month})),!e&&this.setState({tableDataD:s}),s}},{key:"handleExportPart2",value:function(e){var t=null!==e&&void 0!==e?e:F.a.utils.book_new(),a=Object(ue.b)(this.state.tableColumnsD,this.state.tableDataD);F.a.utils.book_append_sheet(t,a,"\u5fc5\u77e5\u5fc5\u4f1a\u8bc4\u4f30\u8868"),!e&&F.a.writeFile(t,"\u5fc5\u77e5\u5fc5\u4f1a\u5206\u6790\u7ed3\u679c.xlsx")}},{key:"handleExportAll",value:function(){Object(ue.a)([{columns:this.state.tableColumnsA,data:this.state.tableDataA,sheetName:"\u6838\u5fc3\u6280\u80fd\u60c5\u51b5\u8868",additionalRows:this.state.tableDataA.filter((function(e){return!e.isCondition})).map((function(e){return"".concat(e.monthName,"\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u57f9\u8bad\u8ba1\u5212\u5b8c\u6210").concat(e.trainPersonCount,"\u4eba\u6b21\uff0c\u5b9e\u9645\u5b8c\u6210").concat(e.trainPersonCount,"\u4eba\u6b21\uff0c\u4e3b\u8981\u5b8c\u6210").concat(e.remarksText,"\u7b49").concat(e.trainProjectCount,"\u4e2a\u6280\u80fd\u9879\u70b9\u7684\u57f9\u8bad\u3002")}))},{columns:this.state.tableColumnsB,data:this.state.tableDataB,sheetName:"\u57f9\u8bad\u57fa\u672c\u60c5\u51b5\u8868"},{columns:this.state.tableColumnsC,data:this.state.tableDataC,sheetName:"\u57f9\u8bad\u5e08\u60c5\u51b5\u8868"},{columns:this.state.tableColumnsD,data:this.state.tableDataD,sheetName:"\u5fc5\u77e5\u5fc5\u4f1a\u8bc4\u4f30\u8868",additionalRows:this.state.tableDataD.filter((function(e){return!e.isCondition})).map((function(e){var t;return"".concat(e.monthName,"\u5b8c\u6210\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u9a8c\u6536\u8bc4\u5b9a").concat(e.assessCount,"\u4eba\uff0c\u5b9e\u9645\u901a\u8fc7").concat(e.passedCount,"\u4eba\uff0c\u901a\u8fc7\u7387\u4e3a").concat((100*(null!==(t=e.passedRate)&&void 0!==t?t:0)).toFixed(2),"%\uff0c\u5176\u4e2d\u7406\u8bba\u9a8c\u6536").concat(e.theoryCount,"\u4eba\uff0c\u5b9e\u64cd\u9a8c\u6536").concat(e.trainCount,"\u4eba\uff0c\u9a8c\u6536\u4e3b\u8981\u6280\u80fd\u9879\u70b9\u4e3a\uff1a").concat(e.remarksText,"\u3002")}))}],"\u57f9\u8bad\u60c5\u51b5\u3001\u5fc5\u77e5\u5fc5\u4f1a\u5206\u6790\u7ed3\u679c")}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("div",{className:"workbench-result ".concat(this.props.className),children:[Object(r.jsx)("div",{className:"workbench-result-toolbar",children:Object(r.jsxs)("div",{className:"workbench-result-btns",children:[Object(r.jsx)(f.a.Group,{children:Object(r.jsx)(f.a,{type:"primary",size:"small",onClick:function(){return e.handleCalcPatr1()},children:"\u5206\u6790\u6708\u5ea6\u57f9\u8bad\u660e\u7ec6\u8868"})}),Object(r.jsx)(f.a.Group,{children:Object(r.jsx)(f.a,{type:"primary",size:"small",onClick:function(){return e.handleCalcPatr2()},children:"\u5206\u6790\u5fc5\u77e5\u5fc5\u4f1a\u8bc4\u4f30\u660e\u7ec6\u8868"})}),Object(r.jsx)(f.a,{size:"small",icon:Object(r.jsx)(H.a,{}),onClick:function(){return e.handleExportAll()},children:"\u6574\u5408\u5bfc\u51fa"})]})}),Object(r.jsx)("div",{className:"workbench-result-tables",children:Object(r.jsxs)(R.a,{defaultActiveKey:"1",tabBarStyle:{padding:"0 10px",marginBottom:"0"},style:{height:"100%"},children:[Object(r.jsxs)(R.a.TabPane,{tab:"\u57f9\u8bad-\u6280\u80fd\u8868",children:[Object(r.jsx)(d.a,{columns:this.state.tableColumnsA,dataSource:this.state.tableDataA,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(r.jsx)(ce,{columns:this.state.tableColumnsA,data:this.state.tableDataA.filter((function(e){return!e.isCondition})),title:"\u6280\u80fd\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"trainProjectCount",label:"\u57f9\u8bad\u9879\u76ee\u6570"},{key:"trainPersonCount",label:"\u57f9\u8bad\u603b\u4eba\u6b21"},{key:"theoryHours",label:"\u7406\u8bba\u57f9\u8bad\u8bfe\u65f6"},{key:"practiceHours",label:"\u5b9e\u64cd\u57f9\u8bad\u8bfe\u65f6"}]}),Object(r.jsx)(B.b,{size:"small",children:this.state.tableDataA.filter((function(e){return!e.isCondition})).map((function(e){return Object(r.jsx)(B.b.Item,{style:{padding:"5px 10px"},children:"".concat(e.monthName,"\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u57f9\u8bad\u8ba1\u5212\u5b8c\u6210").concat(e.trainPersonCount,"\u4eba\u6b21\uff0c\u5b9e\u9645\u5b8c\u6210").concat(e.trainPersonCount,"\u4eba\u6b21\uff0c\u4e3b\u8981\u5b8c\u6210").concat(e.remarksText,"\u7b49").concat(e.trainProjectCount,"\u4e2a\u6280\u80fd\u9879\u70b9\u7684\u57f9\u8bad\u3002")},e.id)}))})]},"1"),Object(r.jsxs)(R.a.TabPane,{tab:"\u57f9\u8bad-\u60c5\u51b5\u8868",children:[Object(r.jsx)(d.a,{columns:this.state.tableColumnsB,dataSource:this.state.tableDataB,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"center",overflowX:"auto"},children:[Object(r.jsx)(ce,{columns:this.state.tableColumnsB,data:this.state.tableDataB.filter((function(e){return!e.isCondition&&"M"===e.type})),title:"\u7ba1\u7406\u4eba\u5458\u60c5\u51b5\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"completeRate",label:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387"}],markLine:1}),Object(r.jsx)(ce,{columns:this.state.tableColumnsB,data:this.state.tableDataB.filter((function(e){return!e.isCondition&&"P"===e.type})),title:"\u751f\u4ea7\u4eba\u5458\u60c5\u51b5\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"completeRate",label:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387"}],markLine:1})]})]},"2"),Object(r.jsxs)(R.a.TabPane,{tab:"\u57f9\u8bad-\u8bb2\u5e08\u8868",children:[Object(r.jsx)(d.a,{columns:this.state.tableColumnsC,dataSource:this.state.tableDataC,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(r.jsx)(ce,{columns:this.state.tableColumnsC,data:this.state.tableDataC.filter((function(e){return!e.isCondition})),title:"\u8bb2\u5e08\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"rate",label:"\u57f9\u8bad\u5e08\u5229\u7528\u7387"}]})]},"3"),Object(r.jsxs)(R.a.TabPane,{tab:"\u77e5\u4f1a-\u8bc4\u4f30\u8868",children:[Object(r.jsx)(d.a,{columns:this.state.tableColumnsD,dataSource:this.state.tableDataD,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(r.jsx)(ce,{columns:this.state.tableColumnsD,data:this.state.tableDataD.filter((function(e){return!e.isCondition})),title:"\u8bc4\u4f30\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"passedRate",label:"\u5408\u683c\u7387"}]}),Object(r.jsx)(B.b,{size:"small",children:this.state.tableDataD.filter((function(e){return!e.isCondition})).map((function(e){var t;return Object(r.jsx)(B.b.Item,{style:{padding:"5px 10px"},children:"".concat(e.monthName,"\u5b8c\u6210\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u9a8c\u6536\u8bc4\u5b9a").concat(e.assessCount,"\u4eba\uff0c\u5b9e\u9645\u901a\u8fc7").concat(e.passedCount,"\u4eba\uff0c\u901a\u8fc7\u7387\u4e3a").concat((100*(null!==(t=e.passedRate)&&void 0!==t?t:0)).toFixed(2),"%\uff0c\u5176\u4e2d\u7406\u8bba\u9a8c\u6536").concat(e.theoryCount,"\u4eba\uff0c\u5b9e\u64cd\u9a8c\u6536").concat(e.trainCount,"\u4eba\uff0c\u9a8c\u6536\u4e3b\u8981\u6280\u80fd\u9879\u70b9\u4e3a\uff1a").concat(e.remarksText,"\u3002")},e.id)}))})]},"4")]})})]})}}]),a}(i.a.Component),he=(a(285),a(122)),pe=(a(331),a(195)),be=(a(550),a(362)),me=a(275),fe=a(95),je=a.n(fe),_e=a(153),ve=(a(552),a(196)),Oe=a(364),xe=a(363),ye=function(e,t){return[{title:"\u5e8f\u53f7",titleName:"\u5e8f\u53f7",key:"_order",dataIndex:"_order",ellipsis:!0,width:60,fixed:!0,render:function(e,t,a){return"".concat(a+1)}}].concat("unmatch"===e?[{title:"\u64cd\u4f5c",titleName:"\u64cd\u4f5c",key:"_operation",dataIndex:"_operation",ellipsis:!0,width:50,fixed:!0,render:function(e,a,n){return Object(r.jsx)(b.a,{title:"\u53d6\u6d88\u5339\u914d",children:Object(r.jsx)(f.a,{ghost:!0,type:"primary",size:"small",icon:Object(r.jsx)(xe.a,{}),shape:"circle",onClick:function(){return t&&t(a,n)},disabled:!a.isMatched})})}}]:"select"===e?[{title:"\u64cd\u4f5c",titleName:"\u64cd\u4f5c",key:"_operation",dataIndex:"_operation",ellipsis:!0,width:50,fixed:!0,render:function(e,a,n){return Object(r.jsx)(f.a,{ghost:!0,type:"primary",size:"small",icon:Object(r.jsx)(me.a,{}),shape:"circle",onClick:function(){return t&&t(a,n)},disabled:a.isMatched})}}]:[],[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:200},{title:"\u59d3\u540d",titleName:"\u59d3\u540d",key:"name",dataIndex:"name",ellipsis:!0,width:80},{title:"\u624b\u673a\u53f7\u7801",titleName:"\u624b\u673a\u53f7\u7801",key:"phone",dataIndex:"phone",ellipsis:!0,width:100},{title:"\u5c97\u4f4d",titleName:"\u5c97\u4f4d",key:"station",dataIndex:"station",ellipsis:!0,width:100},{title:"\u6210\u7ee9",titleName:"\u6210\u7ee9",key:"score",dataIndex:"score",ellipsis:!0,width:100},{title:"\u7ed3\u679c",titleName:"\u7ed3\u679c",key:"result",dataIndex:"result",ellipsis:!0,width:100}])},ge=[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:200},{title:"\u59d3\u540d",titleName:"\u59d3\u540d",key:"name",dataIndex:"name",ellipsis:!0,width:80},{title:"\u624b\u673a\u53f7\u7801",titleName:"\u624b\u673a\u53f7\u7801",key:"phone",dataIndex:"phone",ellipsis:!0,width:100},{title:"\u5c97\u4f4d",titleName:"\u5c97\u4f4d",key:"station",dataIndex:"station",ellipsis:!0,width:150},{title:"\u4e00\u6b21\u6210\u7ee9",titleName:"\u4e00\u6b21\u6210\u7ee9",key:"score1",dataIndex:"score1",ellipsis:!0,width:100},{title:"\u4e00\u6b21\u901a\u8fc7",titleName:"\u4e00\u6b21\u901a\u8fc7",key:"result1",dataIndex:"result1",ellipsis:!0,width:100},{title:"\u4e8c\u6b21\u6210\u7ee9",titleName:"\u4e8c\u6b21\u6210\u7ee9",key:"score2",dataIndex:"score2",ellipsis:!0,width:100},{title:"\u4e8c\u6b21\u901a\u8fc7",titleName:"\u4e8c\u6b21\u901a\u8fc7",key:"result2",dataIndex:"result2",ellipsis:!0,width:100}],Ce=[{title:"\u5355\u4f4d",titleName:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:200},{title:"\u6708\u4efd",titleName:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:80},{title:"\u8003\u8bd5\u4eba\u6570",titleName:"\u8003\u8bd5\u4eba\u6570",key:"joinedPeople",dataIndex:"joinedPeople",ellipsis:!0,width:100},{title:"\u5408\u683c\u7ebf",titleName:"\u5408\u683c\u7ebf",key:"passLine",dataIndex:"passLine",ellipsis:!0,width:100},{title:"\u5e73\u5747\u5206",titleName:"\u5e73\u5747\u5206",key:"averageScores",dataIndex:"averageScores",ellipsis:!0,width:100},{title:"\u5408\u683c\u7387",titleName:"\u5408\u683c\u7387",key:"passedRate",dataIndex:"passedRate",ellipsis:!0,width:100},{title:"\u8865\u8003\u5408\u683c\u7387",titleName:"\u8865\u8003\u5408\u683c\u7387",key:"rePassedRate",dataIndex:"rePassedRate",ellipsis:!0,width:100},{title:"\u4e3b\u8981\u95ee\u9898",titleName:"\u4e3b\u8981\u95ee\u9898",key:"remark",dataIndex:"remark",ellipsis:!0,width:150}],we=new Map([["\u8f66\u95f4",{unitName:"E",name:"A",phone:"G",station:"D"}],["\u59d4\u5916",{unitName:"A",name:"A",phone:"G",station:"D"}],["\u5341\u4e8c\u5c40",{unitName:"C",name:"D",phone:"J",station:"H"}],["\u6b63\u7acb",{unitName:"B",name:"C",phone:"J",station:"E"}],["\u4e0a\u6d77\u4e09\u83f1",{unitName:"B",name:"C",phone:"I",station:"E"}],["\u5965\u7684\u65af",{unitName:"B",name:"C",phone:"I",station:"E"}],["\u8fc5\u8fbe",{unitName:"B",name:"C",phone:"I",station:"E"}],["\u4eca\u521b",{unitName:"B",name:"C",phone:"H",station:"D"}],["\u60e0\u6c11",{unitName:"B",name:"C",phone:"I",station:"E"}],["\u7ef4\u521b",{unitName:"B",name:"C",phone:"I",station:"E"}]]);!function(e){e[e.First=0]="First",e[e.Second=1]="Second"}(le||(le={})),function(e){e.Name="B",e.Phone="C",e.Score="D",e.Pass="E",e.Time="F",e.Duration="G",e.Code="H",e.Major="I",e.Unit="J"}(oe||(oe={}));var Ne,ke=function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){var a=F.a.read(n.result,{type:"array"}),r=a.Sheets[a.SheetNames[0]],s=F.a.utils.sheet_to_json(r,{range:8,header:"A"});t(s)},n.onerror=function(e){a(new Error("load file error"))},n.readAsArrayBuffer(e)}))},De=function(e){e.sort((function(e,t){return e[oe.Time]>t[oe.Time]?1:e[oe.Time]<t[oe.Time]?-1:0}));var t,a=new Set,n=new Set,r=[],s=[],i=Object(_.a)(e);try{for(i.s();!(t=i.n()).done;){var l=t.value,o=l[oe.Name]+l[oe.Phone];a.has(o)?n.has(o)||(n.add(o),s.push(l)):(a.add(o),r.push(l))}}catch(c){i.e(c)}finally{i.f()}return{first:r,second:s}},Se=(a(332),a(217)),Pe=function(e){return Object(r.jsxs)("span",{children:[Object(r.jsx)("span",{className:"color-info",children:"\u5f53\u524d\u5339\u914d\u9879\u4fe1\u606f\uff1a"}),e.infos.map((function(e,t){return Object(r.jsxs)("span",{children:[Object(r.jsxs)("span",{className:"color-info",children:[0===t?"":"\uff0c",e.key,"\uff1a"]}),Object(r.jsx)("span",{className:"fw-b",children:e.value})]},t)}))]})},Ee=Object(w.b)(void 0,(function(e){return{toggleLoading:function(t){return e(A(t))}}}))((function(e){var t=Object(s.useState)(!1),a=Object(K.a)(t,2),n=a[0],i=a[1],l=Object(s.useState)(le.First),o=Object(K.a)(l,2),c=o[0],u=o[1],p=Object(s.useState)([]),m=Object(K.a)(p,2),j=m[0],_=m[1],v=Object(s.useState)(!1),O=Object(K.a)(v,2),x=O[0],y=O[1],g=Object(s.useState)([]),C=Object(K.a)(g,2),w=C[0],N=C[1],k=Object(s.useState)(),D=Object(K.a)(k,2),S=D[0],P=D[1],E=Object(s.useState)(),I=Object(K.a)(E,2),M=I[0],A=I[1],T=Object(s.useState)(),F=Object(K.a)(T,2),L=F[0],R=F[1],B=Object(s.useState)(),H=Object(K.a)(B,2),z=H[0],U=H[1],G=Object(s.useState)(),J=Object(K.a)(G,2),q=J[0],Y=J[1],V=Object(s.useState)(),X=Object(K.a)(V,2),Z=X[0],Q=X[1],$=Object(s.useMemo)((function(){if(!Z)return[];var e=[];return e.push({key:"\u59d3\u540d",value:Z[oe.Name]}),e.push({key:"\u624b\u673a\u53f7\u7801",value:Z[oe.Phone]}),e.push({key:"\u5f97\u5206",value:Z[oe.Score]}),e.push({key:"\u662f\u5426\u901a\u8fc7",value:Z[oe.Pass]}),e.push({key:"\u4ea4\u5377\u65f6\u95f4",value:Z[oe.Time]}),e.push({key:"\u8003\u8bd5\u7528\u65f6",value:Z[oe.Duration]}),e.push({key:"\u5458\u5de5\u7f16\u7801",value:Z[oe.Code]}),e.push({key:"\u6240\u5c5e\u4e13\u4e1a",value:Z[oe.Major]}),e.push({key:"\u6240\u5728\u5355\u4f4d",value:Z[oe.Unit]}),e}),[Z]),ee=Object(s.useMemo)((function(){return c===le.First?e.matchedData.first.length:c===le.Second?e.matchedData.second.length:0}),[c,e.matchedData]);Object(s.useEffect)((function(){le.First===c?_(e.unmatchedData.first):le.Second===c&&_(e.unmatchedData.second)}),[e.unmatchedData]);var te,ae=function(){return i(!1)},ne=ye("select",(function(t,a){t&&Z&&(e.onMatch&&e.onMatch(c,Z,t),y(!1))})),re=function(t,a){e.toggleLoading(!0);var n=[];c===le.First?n=e.matchedData.first:c===le.Second&&(n=e.matchedData.second);var r=null!==t&&void 0!==t?t:S,s=null!==a&&void 0!==a?a:L,i=Boolean(+(null!==S&&void 0!==S?S:0));n=n.filter((function(e){return(void 0===r||e.isMatched===i)&&(void 0===M||e.unitName===M)&&(!s||e.name.includes(s))&&(!z||e.phone.includes(z))&&(!q||e.station.includes(q))})),N(n),setTimeout((function(){return e.toggleLoading(!1)}),0)},se=(te=function(e,t){e&&(Q(e),y(!0),P("0"),R(e[oe.Name]),re("0",e[oe.Name]))},[{title:"\u5e8f\u53f7",titleName:"\u5e8f\u53f7",key:"_order",dataIndex:"_order",ellipsis:!0,width:50,fixed:!0,render:function(e,t,a){return"".concat(a+1)}},{title:"\u64cd\u4f5c",titleName:"\u64cd\u4f5c",key:"_operation",dataIndex:"_operation",ellipsis:!0,width:50,fixed:!0,render:function(e,t,a){return Object(r.jsx)(b.a,{title:"\u624b\u52a8\u5339\u914d",children:Object(r.jsx)(f.a,{ghost:!0,type:"primary",size:"small",icon:Object(r.jsx)(Oe.a,{}),shape:"circle",onClick:function(){return te(t,a)}})})}},{title:"\u59d3\u540d",titleName:"\u59d3\u540d",key:"B",dataIndex:"B",ellipsis:!0,width:80,fixed:!0},{title:"\u624b\u673a\u53f7\u7801",titleName:"\u624b\u673a\u53f7\u7801",key:"C",dataIndex:"C",ellipsis:!0,width:120},{title:"\u5f97\u5206",titleName:"\u5f97\u5206",key:"D",dataIndex:"D",ellipsis:!0,width:100},{title:"\u662f\u5426\u901a\u8fc7",titleName:"\u662f\u5426\u901a\u8fc7",key:"E",dataIndex:"E",ellipsis:!0,width:100},{title:"\u4ea4\u5377\u65f6\u95f4",titleName:"\u4ea4\u5377\u65f6\u95f4",key:"F",dataIndex:"F",ellipsis:!0,width:160},{title:"\u8003\u8bd5\u7528\u65f6",titleName:"\u8003\u8bd5\u7528\u65f6",key:"G",dataIndex:"G",ellipsis:!0,width:100},{title:"\u5458\u5de5\u7f16\u7801",titleName:"\u5458\u5de5\u7f16\u7801",key:"H",dataIndex:"H",ellipsis:!0,width:100},{title:"\u6240\u5c5e\u4e13\u4e1a",titleName:"\u6240\u5c5e\u4e13\u4e1a",key:"I",dataIndex:"I",ellipsis:!0,width:120},{title:"\u6240\u5728\u5355\u4f4d",titleName:"\u6240\u5728\u5355\u4f4d",key:"J",dataIndex:"J",ellipsis:!0,width:160}]);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(pe.a,{count:e.unmatchedDataCount[0]+e.unmatchedDataCount[1],size:"small",offset:[-8,-1],children:Object(r.jsx)(f.a,{size:"small",onClick:function(){return i(!0)},children:"\u67e5\u770b\u672a\u5339\u914d\u6210\u7ee9"})}),Object(r.jsxs)(Se.a,{title:"\u672a\u5339\u914d\u6210\u7ee9\u8be6\u60c5",visible:n,onCancel:ae,onOk:ae,cancelText:"\u5173\u95ed",okText:"\u786e\u5b9a",width:"80vw",bodyStyle:{minHeight:"400px"},destroyOnClose:!0,children:[Object(r.jsxs)("div",{className:"toolbar",children:[Object(r.jsxs)(h.a.Group,{value:c,optionType:"button",size:"small",onChange:function(t){e.toggleLoading(!0),u(t.target.value),t.target.value===le.First?_(e.unmatchedData.first):t.target.value===le.Second&&_(e.unmatchedData.second),setTimeout((function(){return e.toggleLoading(!1)}),0)},children:[Object(r.jsx)(pe.a,{count:e.unmatchedDataCount[0],size:"small",offset:[-8,-1],style:{zIndex:5},children:Object(r.jsx)(h.a.Button,{value:le.First,children:"\u4e00\u6b21\u63d0\u4ea4"})}),Object(r.jsx)(pe.a,{count:e.unmatchedDataCount[1],size:"small",offset:[-8,-1],style:{zIndex:5},children:Object(r.jsx)(h.a.Button,{value:le.Second,children:"\u4e8c\u6b21\u63d0\u4ea4"})})]}),Object(r.jsx)(f.a,{size:"small",type:"primary",onClick:function(){Object(ue.a)([{sheetName:"\u4e00\u6b21\u63d0\u4ea4\u672a\u5339\u914d\u6210\u7ee9",data:e.unmatchedData.first,columns:se},{sheetName:"\u4e8c\u6b21\u63d0\u4ea4\u672a\u5339\u914d\u6210\u7ee9",data:e.unmatchedData.second,columns:se}],"\u672a\u5339\u914d\u6210\u7ee9")},children:"\u5bfc\u51fa"})]}),Object(r.jsx)("div",{style:{overflow:"auto",maxHeight:"60vh",marginTop:"10px"},children:Object(r.jsx)(d.a,{columns:se,dataSource:j,rowKey:"id",size:"small",bordered:!0,pagination:!1})}),Object(r.jsx)(Se.a,{title:"\u624b\u52a8\u5339\u914d\u6210\u7ee9",visible:x,onCancel:function(){return y(!1)},onOk:function(){return y(!1)},width:"80vw",children:Object(r.jsxs)("div",{style:{minHeight:"400px"},children:[Object(r.jsx)("div",{className:"mg-b-10",children:Object(r.jsx)(Pe,{infos:$})}),Object(r.jsxs)("div",{className:"toolbar mg-b-10",children:[Object(r.jsx)(b.a,{title:"\u9009\u62e9\u662f\u5426\u5df2\u5339\u914d",children:Object(r.jsx)(he.a,{className:"field-width-short",size:"small",placeholder:"\u662f\u5426\u5339\u914d",allowClear:!0,options:[{label:"\u5df2\u5339\u914d",value:"1"},{label:"\u672a\u5339\u914d",value:"0"}],value:S,onChange:function(e){return P(e)}})}),Object(r.jsx)(b.a,{title:"\u9009\u62e9\u5355\u4f4d",children:Object(r.jsx)(he.a,{className:"field-width-long",size:"small",placeholder:"\u9009\u62e9\u5355\u4f4d",allowClear:!0,options:e.unitNameSelectOptions,value:M,onChange:function(e){return A(e)}})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u59d3\u540d",children:Object(r.jsx)(W.a,{className:"field-width-short",size:"small",placeholder:"\u8f93\u5165\u59d3\u540d",allowClear:!0,value:L,onChange:function(e){var t;return R((null!==(t=e.target.value)&&void 0!==t?t:"").trim())}})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u624b\u673a\u53f7\u7801",children:Object(r.jsx)(W.a,{className:"field-width",size:"small",placeholder:"\u8f93\u5165\u624b\u673a\u53f7\u7801",allowClear:!0,value:z,onChange:function(e){var t;return U((null!==(t=e.target.value)&&void 0!==t?t:"").trim())}})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u5c97\u4f4d",children:Object(r.jsx)(W.a,{className:"field-width",size:"small",placeholder:"\u8f93\u5165\u5c97\u4f4d",allowClear:!0,value:q,onChange:function(e){var t;return Y((null!==(t=e.target.value)&&void 0!==t?t:"").trim())}})}),Object(r.jsx)(f.a,{type:"primary",size:"small",onClick:function(){return re()},children:"\u641c\u7d22"})]}),Object(r.jsx)(d.a,{columns:ne,dataSource:w,size:"small",bordered:!0,rowKey:"id",pagination:{defaultPageSize:10,showTotal:function(e){return Object(r.jsx)("span",{className:"mg-r-10",children:"\u5f53\u524d\u6761\u6570 / \u603b\u6761\u6570\uff1a".concat(w.length," / ").concat(ee)})},size:"default"},scroll:{x:"max-content"},sticky:!0})]})})]})]})})),Ie=(a(312),a(171)),Me=(a(565),a(360)),Ae=a(104),Te=a.n(Ae),Fe={width:700,height:350},Le="\u673a\u7535\u4e09\u8f66\u95f4",Re=function(e,t,a,n){var r,s,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=null!==(r=null===t||void 0===t?void 0:t.format("YYYY-MM"))&&void 0!==r?r:"",o=[],c=[],u=[],d=Object(_.a)(a);try{for(d.s();!(s=d.n()).done;){var h,p=Object(K.a)(s.value,2),b=p[0],m=p[1];(i||"\u6280\u672f\u7ec4"!==b)&&(b!==Le&&u.push({key:b,value:null!==(h=m[n])&&void 0!==h?h:0}))}}catch(f){d.e(f)}finally{d.f()}return u.sort((function(e,t){return t.value-e.value})),u.forEach((function(e){o.push(e.key),c.push(e.value)})),{title:{text:"\u673a\u7535\u4e09\u8f66\u95f4".concat(l,"\u6708\u8003").concat(e),textAlign:"center",left:"50%"},grid:{bottom:150,left:120},xAxis:{type:"category",axisLabel:{interval:0,rotate:45},data:o},yAxis:{type:"value"},series:[{type:"bar",data:c,label:{show:!0,position:"top",fontSize:10,formatter:function(e){return e.value?(+e.value).toFixed(2):""}},barCategoryGap:"50%"}]}},Be=function(e){var t=Object(s.useState)(!1),a=Object(K.a)(t,2),n=a[0],i=a[1],l=Object(s.useState)(!1),o=Object(K.a)(l,2),c=o[0],u=o[1],d=Object(s.useState)(Te()()),p=Object(K.a)(d,2),m=p[0],j=p[1],v=Object(s.useState)(60),O=Object(K.a)(v,2),x=O[0],y=O[1],g=Object(s.useRef)(null),C=Object(s.useRef)(null),w=Object(s.useRef)(null),N=Object(s.useRef)(null),k=Object(s.useState)("all"),D=Object(K.a)(k,2),S=D[0],P=D[1],E=Object(s.useMemo)((function(){for(var t=[new Map,new Map],a=[e.datas.first,e.datas.second],n=function(e){var n=t[e];a[e].forEach((function(e){if(!("inside"===S&&!0===e.isOutsource||"outside"===S&&!1===e.isOutsource))if(n.has(e.unitName)){var t=n.get(e.unitName);t&&(t.totalPeople+=1,t.joinedPeople+=e.score?1:0,t.passedPeople+="\u662f"===e.result?1:0,t.totalScores+=e.score?+e.score:0)}else n.set(e.unitName,{totalPeople:1,joinedPeople:e.score?1:0,passedPeople:"\u662f"===e.result?1:0,totalScores:e.score?+e.score:0,isOutsource:e.isOutsource})}))},r=0;r<a.length;r++)n(r);for(var s=0;s<t.length;s++){var i,l={totalPeople:0,joinedPeople:0,passedPeople:0,totalScores:0,isOutsource:!1},o=Object(_.a)(t[s].values());try{for(o.s();!(i=o.n()).done;){var c=i.value;c.passedRate=c.joinedPeople?c.passedPeople/c.joinedPeople:0,c.averageScores=c.joinedPeople?c.totalScores/c.joinedPeople:0,c.joinedRate=c.totalPeople?c.joinedPeople/c.totalPeople:0,l.totalPeople+=c.totalPeople,l.joinedPeople+=c.joinedPeople,l.passedPeople+=c.passedPeople,l.totalScores+=c.totalScores}}catch(u){o.e(u)}finally{o.f()}l.passedRate=l.joinedPeople?l.passedPeople/l.joinedPeople:0,l.averageScores=l.joinedPeople?l.totalScores/l.joinedPeople:0,l.joinedRate=l.totalPeople?l.joinedPeople/l.totalPeople:0,t[s].set(Le,l)}return t}),[e.datas,S]);Object(s.useEffect)((function(){if(g.current&&C.current&&w.current&&N.current&&n){var e=Z.init(g.current,{},Fe),t=Re("\u53c2\u52a0\u8003\u8bd5\u7387",m,E[0],"joinedRate",c),a=Z.init(C.current,{},Fe),r=Re("\u4e00\u6b21\u901a\u8fc7\u7387",m,E[0],"passedRate",c),s=Z.init(w.current,{},Fe),i=Re("\u4e8c\u6b21\u901a\u8fc7\u7387",m,E[1],"passedRate",c),l=Z.init(N.current,{},Fe),o=Re("\u5e73\u5747\u5206",m,E[0],"averageScores",c);return e.setOption(t),a.setOption(r),s.setOption(i),l.setOption(o),function(){e.dispose(),a.dispose(),s.dispose(),l.dispose()}}}),[E,m,c,n]);var I=function(){return i(!1)},M=Object(s.useMemo)((function(){var e,t,a,n=E[0].get(Le),r=E[1].get(Le);if(!n||!r)return"";var s=m?m.month()+1:"-";return"".concat(Le).concat(s,"\u6708\u6708\u8003\u8003\u8bd5\u4eba\u6570").concat(n.joinedPeople,"\u4eba\uff0c\u5408\u683c\u7ebf").concat(x.toFixed(2),"\u5206\uff0c\u5e73\u5747\u5206").concat(null===(e=n.averageScores)||void 0===e?void 0:e.toFixed(2),"\u5206\uff0c\u5408\u683c\u7387").concat((100*(null!==(t=n.passedRate)&&void 0!==t?t:0)).toFixed(2),"%\uff0c\u8865\u8003\u5408\u683c\u7387").concat((100*(null!==(a=r.passedRate)&&void 0!==a?a:0)).toFixed(2),"%")}),[E,m,x]);return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(f.a,{size:"small",onClick:function(){return i(!0)},children:"\u67e5\u770b\u56fe\u8868"}),Object(r.jsxs)(Se.a,{title:"\u67e5\u770b\u56fe\u8868",visible:n,onCancel:I,onOk:I,cancelText:"\u5173\u95ed",okText:"\u786e\u5b9a",width:"80vw",style:{top:"40px"},children:[Object(r.jsxs)("div",{className:"flex-h-sb",children:[Object(r.jsxs)("div",{className:"toolbar mg-b-10",children:[Object(r.jsx)(f.a,{size:"small",type:"primary",onClick:function(){var e,t,a=[],n=Date.now(),r=Object(_.a)(E[0]);try{for(r.s();!(t=r.n()).done;){var s=Object(K.a)(t.value,2),i=s[0],l=s[1];if(c||"\u6280\u672f\u7ec4"!==i){var o=E[1].get(i);a.push({id:(n++).toString(),unitName:i,monthName:m?m.month()+1+"\u6708":"-",totalPeople:l.totalPeople,joinedPeople:l.joinedPeople,passedPeople:l.passedPeople,totalScores:l.totalPeople,isOutsource:l.isOutsource,passedRate:l.passedRate,averageScores:l.averageScores,rePassedRate:o?o.passedRate:void 0,passLine:x})}}}catch(u){r.e(u)}finally{r.f()}Object(ue.a)([{columns:Ce,data:a,sheetName:"\u6708\u8003\u7edf\u8ba1\u8868",additionalRows:[M]}],"".concat(null!==(e=null===m||void 0===m?void 0:m.format("YYYY-MM"))&&void 0!==e?e:"","\u6708\u8003\u7edf\u8ba1\u8868"))},children:"\u5bfc\u51fa\u8868\u683c\u6570\u636e"}),Object(r.jsxs)(h.a.Group,{size:"small",value:S,onChange:function(e){return P(e.target.value)},children:[Object(r.jsx)(h.a,{value:"all",children:"\u5168\u90e8"}),Object(r.jsx)(h.a,{value:"inside",children:"\u8f66\u95f4"}),Object(r.jsx)(h.a,{value:"outside",children:"\u59d4\u5916"})]}),Object(r.jsx)(b.a,{title:"\u9009\u62e9\u8003\u8bd5\u65e5\u671f",children:Object(r.jsx)(Me.a,{picker:"month",size:"small",value:m,onChange:function(e,t){return j(e)},placeholder:"\u9009\u62e9\u65e5\u671f"})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u5408\u683c\u7ebf",children:Object(r.jsx)(W.a,{className:"field-width-short",size:"small",type:"number",min:0,max:1e3,step:1,value:x,onChange:function(e){return y(+e.target.value||0)}})}),Object(r.jsx)(Ie.a,{checked:c,onChange:function(e){return u(e.target.checked)},children:"\u662f\u5426\u7edf\u8ba1\u6280\u672f\u7ec4"})]}),Object(r.jsx)("div",{children:M})]}),Object(r.jsxs)("div",{className:V.a["modal-charts-container"],children:[Object(r.jsx)("canvas",{className:V.a.chart,ref:g}),Object(r.jsx)("canvas",{className:V.a.chart,ref:C}),Object(r.jsx)("canvas",{className:V.a.chart,ref:w}),Object(r.jsx)("canvas",{className:V.a.chart,ref:N})]})]})]})},He=Object(w.b)(void 0,(function(e){return{toggleLoading:function(t){return e(A(t))}}}))((function(e){var t=Object(s.useState)([]),a=Object(K.a)(t,2),n=a[0],i=a[1],l=Object(s.useState)([]),o=Object(K.a)(l,2),c=o[0],u=o[1],m=Object(s.useState)([]),O=Object(K.a)(m,2),x=O[0],y=O[1],g=Object(s.useState)(le.First),C=Object(K.a)(g,2),w=C[0],N=C[1],k=Object(s.useState)(null),D=Object(K.a)(k,2),S=D[0],P=D[1],E=Object(s.useState)({first:[],second:[]}),I=Object(K.a)(E,2),M=I[0],A=I[1],T=Object(s.useState)({first:[],second:[]}),F=Object(K.a)(T,2),L=F[0],R=F[1],B=Object(s.useState)([]),z=Object(K.a)(B,2),U=z[0],G=z[1],J=Object(s.useState)([]),q=Object(K.a)(J,2),Y=q[0],V=q[1],X=Object(s.useState)([]),Z=Object(K.a)(X,2),Q=Z[0],$=Z[1],ee=Object(s.useState)([]),te=Object(K.a)(ee,2),ae=te[0],ne=te[1],re=Object(s.useState)(),se=Object(K.a)(re,2),ie=se[0],ce=se[1],de=Object(s.useState)(),fe=Object(K.a)(de,2),Oe=fe[0],xe=fe[1],Ce=Object(s.useState)(),Ne=Object(K.a)(Ce,2),Se=Ne[0],Pe=Ne[1],Ie=Object(s.useState)(),Me=Object(K.a)(Ie,2),Ae=Me[0],Te=Me[1],Fe=Object(s.useState)(),Le=Object(K.a)(Fe,2),Re=Le[0],He=Le[1],ze=Date.now(),Ke=Object(s.useMemo)((function(){return[L.first.length,L.second.length]}),[L]),Ue=function(){var t=Object(_e.a)(je.a.mark((function t(){return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.length){t.next=2;break}return t.abrupt("return",ve.b.warning("\u8bf7\u5148\u751f\u6210\u540d\u5355\uff01"));case 2:if(x.length){t.next=4;break}return t.abrupt("return",ve.b.warning("\u8bf7\u5148\u5bfc\u5165\u6210\u7ee9excel\uff01"));case 4:return e.toggleLoading(!0),t.prev=5,t.delegateYield(je.a.mark((function e(){var t,a,r,s,i,l,o,c,u,d,h,p,b,m,f,j,O,y,g;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],a=Date.now(),r=Object(_.a)(x),e.prev=3,r.s();case 5:if((s=r.n()).done){e.next=14;break}if(!(i=s.value).originFileObj){e.next=12;break}return e.next=10,ke(i.originFileObj);case 10:l=e.sent,t.push.apply(t,Object(v.a)(l));case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:for(t.forEach((function(e){return e.id=(a++).toString()})),o=De(t),c=new Map,u=new Map,o.first.forEach((function(e){return c.set(e.id,e)})),o.second.forEach((function(e){return u.set(e.id,e)})),P({first:c,second:u}),d=new Map,h=[],p=[],b=JSON.parse(JSON.stringify(n)),m=JSON.parse(JSON.stringify(n)),f=[h,p],j=[b,m],O=[o.first,o.second],y=function(e){d.clear(),j[e].forEach((function(e){return d.set(e.phone,e)})),O[e].forEach((function(t){var a=t[oe.Phone];if(d.has(a)){var n=d.get(a);n&&(n.score=Number(t[oe.Score]),n.result=t[oe.Pass],n.isMatched=!0,n.matchedId=t.id)}else f[e].push(t)}))},g=0;g<O.length;g++)y(g);A({first:b,second:m}),R({first:h,second:p}),w===le.First?Ge(b):w===le.Second&&Ge(m);case 42:case"end":return e.stop()}}),e,null,[[3,16,19,22]])}))(),"t0",7);case 7:t.next=11;break;case 9:t.prev=9,t.t1=t.catch(5);case 11:return t.prev=11,e.toggleLoading(!1),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[5,9,11,14]])})));return function(){return t.apply(this,arguments)}}(),We=ye("unmatch",(function(e,t){if(e&&e.isMatched&&S&&void 0!==t){var a,r=L.first,s=L.second,i=c[t],l=[];w===le.First?(a=S.first.get(e.matchedId),l=r):w===le.Second&&(a=S.second.get(e.matchedId),l=s),a&&l&&(l.push(a),R({first:r,second:s}),i.score=void 0,i.isMatched=!1,i.matchedId=void 0,i.result=void 0,Ge(Object(v.a)(n)))}})),Ge=function(t){e.toggleLoading(!0),t&&i(t),t=t||n;var a=Boolean(+(null!==ie&&void 0!==ie?ie:0));t=t.filter((function(e){return(void 0===ie||e.isMatched===a)&&(void 0===Oe||e.unitName===Oe)&&(!Se||e.name.includes(Se))&&(!Ae||e.phone.includes(Ae))&&(!Re||e.station.includes(Re))})),u(t),setTimeout((function(){return e.toggleLoading(!1)}),0)};return Object(r.jsxs)("div",{className:"workbench-result ".concat(e.className),children:[Object(r.jsx)("div",{className:"workbench-result-toolbar",children:Object(r.jsxs)("div",{className:"workbench-result-btns",children:[Object(r.jsxs)(f.a.Group,{size:"small",children:[Object(r.jsx)(f.a,{type:"primary",onClick:function(){return function(){if(!U.length&&(!Y.length||!Q.length))return ve.b.warning("\u8bf7\u5148\u9009\u62e9\u8f66\u95f4\u548c\u59d4\u5916\u7684\u540d\u5355\u6587\u4ef6\uff01");e.toggleLoading(!0),setTimeout(Object(_e.a)(je.a.mark((function t(){var a,n,r,s,i,l,o,c,u,d,h,p,b;return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Set,t.next=3,Object(ue.c)(null===(a=U[0])||void 0===a?void 0:a.originFileObj);case 3:return r=t.sent,s="single",t.next=7,Object(_e.a)(je.a.mark((function e(){var t,a;return je.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Y.length){e.next=7;break}return s="multi",e.next=4,Object(ue.c)(null===(t=Y[0])||void 0===t?void 0:t.originFileObj);case 4:return e.abrupt("return",e.sent);case 7:return s="single",e.next=10,Object(ue.c)(null===(a=Q[0])||void 0===a?void 0:a.originFileObj);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})))();case 7:if(i=t.sent,r.size||i.size){t.next=11;break}return e.toggleLoading(!1),t.abrupt("return");case 11:for(u in o=[],c=function(e){var t,a=l[e],r=Object(_.a)(a.entries());try{var i=function(){var a=Object(K.a)(t.value,2),r=a[0],i=a[1],l=we.get("0"===e?"\u8f66\u95f4":"single"===s?"\u59d4\u5916":r),c=[];l&&i.forEach((function(t){var a="",r=t[l.name];if("0"===e){var i=t[l.unitName].split("/");a=i[i.length-1]}else if("single"===s){var u=t[l.unitName].split("-");a=u[0],r=u[1]}else a=t[l.unitName];n.add(a);var d={id:(ze++).toString(),unitName:a,name:r,phone:t[l.phone],station:t[l.station],isOutsource:"1"===e,isMatched:!1};c.push(d),o.push(d)}))};for(r.s();!(t=r.n()).done;)i()}catch(c){r.e(c)}finally{r.f()}},l=[r,i])c(u);Ge(o),d=[],h=Object(_.a)(n.keys());try{for(h.s();!(p=h.n()).done;)b=p.value,d.push({label:b,value:b})}catch(m){h.e(m)}finally{h.f()}ne(d),e.toggleLoading(!1);case 21:case"end":return t.stop()}}),t)}))),0)}()},children:"\u751f\u6210\u540d\u5355"}),Object(r.jsx)(be.a,{title:"\u9009\u62e9\u82b1\u540d\u518c",placement:"bottomLeft",trigger:["click"],content:Object(r.jsxs)("div",{className:"workbench-result-uploads-box",children:[Object(r.jsx)(p.a,{accept:".xlsx, .xls",fileList:U,beforeUpload:function(){return!1},className:"upload",onChange:function(e){var t=e.fileList.slice(-1);G(t)},children:Object(r.jsx)(f.a,{size:"small",icon:Object(r.jsx)(j.a,{}),children:"\u9009\u62e9\u8f66\u95f4\u901a\u8baf\u5f55"})}),Object(r.jsx)(p.a,{disabled:!!Y.length,accept:".xlsx, .xls",fileList:Q,beforeUpload:function(){return!1},className:"upload",onChange:function(e){var t=e.fileList.slice(-1);$(t)},children:Object(r.jsx)(f.a,{disabled:!!Y.length,size:"small",icon:Object(r.jsx)(j.a,{}),children:"\u9009\u62e9\u59d4\u5916\u901a\u8baf\u5f55"})}),Object(r.jsx)(p.a,{disabled:!!Q.length,accept:".xlsx, .xls",fileList:Y,beforeUpload:function(){return!1},className:"upload",onChange:function(e){var t=e.fileList.slice(-1);V(t)},children:Object(r.jsx)(f.a,{disabled:!!Q.length,size:"small",icon:Object(r.jsx)(j.a,{}),children:"\u9009\u62e9\u59d4\u5916\u82b1\u540d\u518c"})})]}),children:Object(r.jsx)(f.a,{icon:Object(r.jsx)(me.a,{}),children:"\u9009\u62e9"})})]}),Object(r.jsx)(p.a,{accept:".xlsx, .xls",fileList:x,beforeUpload:function(){return!1},onChange:function(e){return y(e.fileList)},multiple:!0,className:"workbench-result-upload".concat(x.length?"":" is-empty"),children:Object(r.jsx)(pe.a,{count:x.length,size:"small",offset:[-8,-1],children:Object(r.jsx)(f.a,{size:"small",icon:Object(r.jsx)(j.a,{}),children:"\u9009\u62e9\u6210\u7ee9\u6587\u4ef6"})})}),Object(r.jsx)(f.a,{size:"small",type:"primary",onClick:function(){return Ue()},children:"\u786e\u8ba4\u5bfc\u5165"}),S?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(h.a.Group,{options:[{label:"\u4e00\u6b21\u63d0\u4ea4",value:le.First},{label:"\u4e8c\u6b21\u63d0\u4ea4",value:le.Second}],value:w,optionType:"button",size:"small",onChange:function(t){N(t.target.value),e.toggleLoading(!0),t.target.value===le.First?Ge(M.first):t.target.value===le.Second&&Ge(M.second),setTimeout((function(){return e.toggleLoading(!1)}),0)}}),Object(r.jsx)(Ee,{matchedData:M,unmatchedDataCount:Ke,unmatchedData:L,unitNameSelectOptions:ae,onMatch:function(e,t,a){if(a.isMatched=!0,a.matchedId=t.id,a.result=t[oe.Pass],a.score=t[oe.Score],e===le.First){var n=L.first,r=n.findIndex((function(e){return e.id===t.id}));n.splice(r,1),R({first:Object(v.a)(n),second:L.second})}else if(e===le.Second){var s=L.second,i=s.findIndex((function(e){return e.id===t.id}));s.splice(i,1),R({first:L.first,second:Object(v.a)(s)})}Ge(),A({first:M.first,second:M.second})}}),Object(r.jsx)(Be,{datas:M}),Object(r.jsx)(f.a,{size:"small",icon:Object(r.jsx)(H.a,{}),onClick:function(){var e=[];M.first.forEach((function(t,a){e.push({unitName:t.unitName,phone:t.phone,station:t.station,name:t.name,score1:t.score,result1:t.result,score2:M.second[a].score,result2:M.second[a].result})})),Object(ue.a)([{sheetName:"\u6210\u7ee9\u5355",columns:ge,data:e}],"\u5b8c\u6574\u6210\u7ee9\u5355")},children:"\u5bfc\u51fa\u6210\u7ee9"})]}):null]})}),Object(r.jsxs)("div",{className:"workbench-result-tables",children:[Object(r.jsxs)("div",{className:"toolbar",children:[Object(r.jsx)(b.a,{title:"\u9009\u62e9\u662f\u5426\u5df2\u5339\u914d",children:Object(r.jsx)(he.a,{className:"field-width-short",size:"small",placeholder:"\u662f\u5426\u5339\u914d",allowClear:!0,options:[{label:"\u5df2\u5339\u914d",value:"1"},{label:"\u672a\u5339\u914d",value:"0"}],value:ie,onChange:function(e){return ce(e)}})}),Object(r.jsx)(b.a,{title:"\u9009\u62e9\u5355\u4f4d",children:Object(r.jsx)(he.a,{className:"field-width-long",size:"small",placeholder:"\u9009\u62e9\u5355\u4f4d",allowClear:!0,options:ae,value:Oe,onChange:function(e){return xe(e)}})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u59d3\u540d",children:Object(r.jsx)(W.a,{className:"field-width",size:"small",placeholder:"\u8f93\u5165\u59d3\u540d",allowClear:!0,value:Se,onChange:function(e){var t;return Pe((null!==(t=e.target.value)&&void 0!==t?t:"").trim())}})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u624b\u673a\u53f7\u7801",children:Object(r.jsx)(W.a,{className:"field-width",size:"small",placeholder:"\u8f93\u5165\u624b\u673a\u53f7\u7801",allowClear:!0,value:Ae,onChange:function(e){var t;return Te((null!==(t=e.target.value)&&void 0!==t?t:"").trim())}})}),Object(r.jsx)(b.a,{title:"\u8f93\u5165\u5c97\u4f4d",children:Object(r.jsx)(W.a,{className:"field-width",size:"small",placeholder:"\u8f93\u5165\u5c97\u4f4d",allowClear:!0,value:Re,onChange:function(e){var t;return He((null!==(t=e.target.value)&&void 0!==t?t:"").trim())}})}),Object(r.jsx)(f.a,{type:"primary",size:"small",onClick:function(){return Ge()},children:"\u641c\u7d22"})]}),Object(r.jsx)(d.a,{className:"result-cross-table",columns:We,dataSource:c,size:"small",bordered:!0,rowKey:"id",pagination:{defaultPageSize:20,showTotal:function(e){return Object(r.jsx)("span",{className:"mg-r-10",children:"\u5f53\u524d\u6761\u6570 / \u603b\u6761\u6570\uff1a".concat(c.length," / ").concat(n.length)})},size:"default"},scroll:{x:"max-content"},sticky:!0})]})]})}));!function(e){e[e.Train=0]="Train",e[e.Score=1]="Score"}(Ne||(Ne={}));var ze,Ke=C.a.Content,Ue="\u6682\u65e0\uff0c\u8bf7\u5bfc\u5165\u6587\u4ef6",We=function(e){Object(y.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(O.a)(this,a),(n=t.call(this,e)).workbook=null,n.sheetsWrapper=i.a.createRef(),n.sheetScroll=null,n.tableColumnsCaches={},n.tableDataCaches={},n.handleBeforeUpload=function(e,t){return!1},n.uploadOnChange=function(e){var t=e.fileList.slice(-1);n.setState({fileList:t}),0===t.length?n.clearFile():n.loadFile(t[0].originFileObj)},n.loadFile=function(e,t){if(e){var a=new FileReader;a.onloadstart=function(e){n.props.toggleLoading(!0)},a.onloadend=function(e){n.props.toggleLoading(!1)},a.onload=function(e){n.workbook=F.a.read(a.result,{type:"array"}),n.setState({sheetNames:Object(v.a)(n.workbook.SheetNames),currentSheet:n.workbook.SheetNames.length?n.workbook.SheetNames[0]:""}),window.workbook=n.workbook},a.readAsArrayBuffer(e)}},n.clearFile=function(){n.tableColumnsCaches={},n.tableDataCaches={},n.setState({tableColumns:[{title:Ue,titleName:Ue}],tableData:[],sheetNames:[],currentSheet:"",fileList:[]})},n.handleSheetChange=function(e){n.setState({currentSheet:e.target.value}),n.switchSheet(e.target.value)},n.state={fileList:[],sheetNames:[],currentSheet:"",tableData:[],tableColumns:[{title:Ue,titleName:Ue}],allTableData:[],currentAnalysisType:Ne.Score},n}return Object(x.a)(a,[{key:"createTableData",value:function(e,t){var a,n,r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null!==(a=null!==(n=null===t||void 0===t||null===(r=t["!autofilter"])||void 0===r?void 0:r.ref)&&void 0!==n?n:null===t||void 0===t?void 0:t["!ref"])&&void 0!==a?a:"";if(e in this.tableColumnsCaches)return{header:this.tableColumnsCaches[e],body:this.tableDataCaches[e]};if(!s)return{header:[],body:[]};var i=F.a.utils.decode_range(s),l=new Set;t["!merges"]&&t["!merges"].forEach((function(e){for(var t=e.s.r;t<=e.e.r;t++)l.add(t)}));for(var o=new Set,c=i.s.r;c<=i.e.r&&t["A"+(c+1)];c++)l.has(c)||o.add(c+1);for(var u=o.values().next().value,d=new Set,h=i.s.c;h<=i.e.c;h++){var p=F.a.utils.encode_col(h);if(!t[p+u])break;d.add(p)}var b,m=[],f=Object(_.a)(d.values());try{for(f.s();!(b=f.n()).done;){var j=b.value,v=j+u,O=t[v].w+"(".concat(j,")"),x=O.length,y={titleName:O,title:O,key:j,dataIndex:j,width:"calc(".concat((x>=4?x:4)+"em"," + 17px)"),ellipsis:!0};m.push(y)}}catch(T){f.e(T)}finally{f.f()}var g=[],C=o.values();C.next();var w,N=Object(_.a)(C);try{for(N.s();!(w=N.n()).done;){var k,D=w.value,S={id:D+""},P=Object(_.a)(d.values());try{for(P.s();!(k=P.n()).done;){var E,I,M,A=k.value;if("d"===(null===(E=t[A+D])||void 0===E?void 0:E.t))S[A]=t[A+D].v.toLocaleDateString();else S[A]=null!==(I=null===(M=t[A+D])||void 0===M?void 0:M.w)&&void 0!==I?I:""}}catch(T){P.e(T)}finally{P.f()}g.push(S)}}catch(T){N.e(T)}finally{N.f()}return this.tableColumnsCaches[e]=m,this.tableDataCaches[e]=g,{header:m,body:g}}},{key:"switchSheet",value:function(e){var t,a,n;if(this.workbook){var r=this.workbook.Sheets[e],s=null!==(t=null!==(a=null===r||void 0===r||null===(n=r["!autofilter"])||void 0===n?void 0:n.ref)&&void 0!==a?a:null===r||void 0===r?void 0:r["!ref"])&&void 0!==t?t:"";if(s)if(e in this.tableColumnsCaches)this.setState({tableColumns:this.tableColumnsCaches[e],tableData:this.tableDataCaches[e].slice(0,20),allTableData:this.tableDataCaches[e]});else{var i=this.createTableData(e,r,s),l=i.header,o=i.body;this.setState({tableColumns:l,tableData:o.slice(0,20),allTableData:o})}else this.setState({tableColumns:[]})}}},{key:"componentDidMount",value:function(){this.sheetsWrapper.current&&(this.sheetScroll=new L.a(this.sheetsWrapper.current,{scrollX:!0,scrollY:!0,click:!0,bounce:!1}))}},{key:"componentDidUpdate",value:function(e,t){this.state.sheetNames!==t.sheetNames&&this.sheetScroll&&(this.sheetScroll.refresh(),this.switchSheet(this.state.currentSheet))}},{key:"test",value:function(e){var t=this;(function(e){return new Promise(function(){var t=Object(_e.a)(je.a.mark((function t(a,n){var r,s;return je.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.fetch(e);case 3:if(!((r=t.sent).status>=200&&r.status<300)){t.next=11;break}return t.next=7,r.blob();case 7:s=t.sent,a(s),t.next=12;break;case 11:n(new Error("fetch file error !"));case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),n(new Error("get file error !"));case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,a){return t.apply(this,arguments)}}())})(e).then((function(e){t.loadFile(e)})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;return Object(r.jsx)(C.a,{className:"workbench",children:Object(r.jsxs)(Ke,{className:"workbench-content",children:[Object(r.jsxs)("div",{className:"workbench-operation",children:[Object(r.jsx)("div",{className:"workbench-operation-left",children:Object(r.jsxs)(p.a,{accept:".xlsx, .xls",fileList:this.state.fileList,beforeUpload:this.handleBeforeUpload,onChange:this.uploadOnChange,children:[Object(r.jsx)(f.a,{size:"small",icon:Object(r.jsx)(j.a,{}),children:"\u5bfc\u5165\u672c\u5730\u6587\u4ef6"}),Object(r.jsx)(b.a,{title:"\u9884\u89c8\u53ea\u5c55\u793a\u524d20\u884c\u6570\u636e",placement:"right",className:"mg-l-10",children:Object(r.jsx)(m.a,{})})]})}),Object(r.jsx)("div",{className:"workbench-operation-right",children:Object(r.jsx)("div",{className:"sheets",ref:this.sheetsWrapper,children:Object(r.jsx)(h.a.Group,{size:"small",value:this.state.currentSheet,onChange:this.handleSheetChange,children:this.state.sheetNames.map((function(e,t){return Object(r.jsx)(h.a.Button,{value:e,children:e},e.toString()+t)}))})})})]}),Object(r.jsxs)("div",{className:"workbench-preview",children:[Object(r.jsxs)("div",{className:"workbench-preview-main-table-container",children:[Object(r.jsx)(d.a,{columns:this.state.tableColumns,dataSource:this.state.tableData,size:"small",bordered:!0,scroll:{x:"max-content",y:150},rowKey:"id",pagination:!1,sticky:!0}),Object(r.jsx)("div",{className:"additional-toolbar",children:Object(r.jsx)(h.a.Group,{options:[{label:"\u57f9\u8bad\u5206\u6790\u5904\u7406",value:Ne.Train},{label:"\u8003\u8bc4\u6210\u7ee9\u5904\u7406",value:Ne.Score}],value:this.state.currentAnalysisType,optionType:"button",size:"small",onChange:function(t){e.props.toggleLoading(!0),setTimeout((function(){e.setState({currentAnalysisType:t.target.value},(function(){return setTimeout((function(){return e.props.toggleLoading(!1)}),0)}))}))}})})]}),Object(r.jsxs)("div",{className:"workbench-preview-tabs",children:[Object(r.jsx)(de,{className:"page "+(this.state.currentAnalysisType===Ne.Train?"":"none"),outerColumns:this.state.tableColumns,outerData:this.state.allTableData}),Object(r.jsx)(He,{className:"page "+(this.state.currentAnalysisType===Ne.Score?"":"none"),outerColumns:this.state.tableColumns,outerData:this.state.allTableData,currentSheetName:this.state.currentSheet})]})]})]})})}}]),a}(i.a.PureComponent),Ge=Object(w.b)((function(e){return{loading:e.global.loading}}),(function(e){return{toggleLoading:function(t){return e(A(t))}}}))(We),Je=(a(310),a(265)),qe=a(339),Ye=a.n(qe);!function(e){e.Normal="normal",e.Exception="exception",e.Active="active",e.Success="success"}(ze||(ze={}));var Ve=function(){var e=Object(w.c)(),t=Object(w.d)((function(e){return e.global.showProgress})),a=Object(w.d)((function(e){return e.global.percent})),n=Object(s.useState)(ze.Normal),i=Object(K.a)(n,2),l=i[0],o=i[1];return Object(s.useEffect)((function(){100===a&&l!==ze.Success?o(ze.Success):100!==a&&l===ze.Success&&o(ze.Normal)}),[a,l]),100===a&&setTimeout((function(){e(I(!1)),e(M(0))}),1e3),Object(r.jsx)("div",{className:Ye.a["process-wrapper"],style:{display:t?"":"none"},children:Object(r.jsx)(Je.a,{percent:a,size:"small",status:l})})},Xe=(a(282),a(185)),Ze=a(340),Qe=a.n(Ze),$e=function(){var e=Object(w.d)((function(e){return e.global.loading}));return Object(r.jsx)("div",{className:Qe.a["loading-wrapper"],style:{display:e?"":"none"},children:Object(r.jsx)(Xe.a,{size:"large"})})},et=function(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ve,{}),Object(r.jsx)($e,{}),Object(r.jsx)(c.a,{children:Object(r.jsxs)(u.d,{children:[Object(r.jsx)(u.b,{path:"/index",exact:!0,component:Ge}),Object(r.jsx)(u.a,{to:"/index"})]})})]})},tt=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,579)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),s(e),i(e)}))},at=a(181),nt={showProgress:!1,percent:0,loading:!1},rt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case S:return Object(z.a)(Object(z.a)({},t),{},{showProgress:void 0!==a.payload.show?a.payload.show:!t.showProgress});case P:var n=null!==(e=a.payload.percent)&&void 0!==e?e:0;return n=n<0?0:n>100?100:n,Object(z.a)(Object(z.a)({},t),{},{percent:n});case E:return Object(z.a)(Object(z.a)({},t),{},{loading:void 0!==a.payload.loading?a.payload.loading:!t.loading});default:return t}},st=Object(at.b)({global:rt}),it=Object(at.c)(st),lt=a(338),ot=a.n(lt);a(379);Te.a.locale("zh-cn"),o.a.render(Object(r.jsx)(w.a,{store:it,children:Object(r.jsx)(n.a,{locale:ot.a,children:Object(r.jsx)(et,{})})}),document.getElementById("root")),tt()},93:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return generateExcelSheet})),__webpack_require__.d(__webpack_exports__,"a",(function(){return exportExcelFile})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getTableDatasFromExcel}));var E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(95),E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(153),E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(230),E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(34),E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(60),xlsx__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(72),xlsx__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_5__),pretreatFormula=function(e){return e},COL_MATCH_REG=/(?<=^|\+|-|\*|\/|\\|\^|\.|\(|\)|\[|\]|,|\s)([A-Z]+)(?=$|\+|-|\*|\/|\\|\^|\.|\(|\)|\[|\]|,|\s)/g,formatFormula=function(e,t){return e?t=pretreatFormula(t).replace(COL_MATCH_REG,(function(t,a){var n,r;return(null===(n=e.get(a))||void 0===n||null===(r=n.title)||void 0===r?void 0:r.toString())||""})):""},ROW_OBJ_NAME="rowObj",resolveFormula=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ROW_OBJ_NAME;return e?e=pretreatFormula(e).replace(COL_MATCH_REG,(function(e,a){return"".concat(t,".").concat(a)})):""},validateFormula=function validateFormula(formula,row,map,data){if(!formula)return!1;if(/([^a-zA-Z0-9+\-*/\s^.()',\[\]])/.test(formula))return!1;var resolvedFormula=resolveFormula(formula),rowObj=data[0];console.log(resolvedFormula);try{var res=eval(resolvedFormula);return res}catch(err){return!1}},generateExcelSheet=function(e,t,a){var n=new Map,r=[],s=[];if(e.filter((function(e){var t;return/^[^_]/.test((null!==(t=e.dataIndex)&&void 0!==t?t:"").toString())})).forEach((function(e,t){var a,r,i=e.titleName.toString();n.set((null!==(a=e.key)&&void 0!==a?a:"").toString(),i),s.push({wpx:Number(null!==(r=e.width)&&void 0!==r?r:100)})})),t.forEach((function(e){var t,a={},s=Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__.a)(n.entries());try{for(s.s();!(t=s.n()).done;){var i=Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__.a)(t.value,2),l=i[0];a[i[1]]=e[l]}}catch(o){s.e(o)}finally{s.f()}r.push(a)})),a){r.push({});var i=n.values().next().value;a.forEach((function(e){return r.push(Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__.a)({},i,e))}))}var l=xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.utils.json_to_sheet(r);return l["!cols"]=s,l},exportExcelFile=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u5bfc\u51fa\u7ed3\u679c",a=xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.utils.book_new();e.forEach((function(e){var t=generateExcelSheet(e.columns,e.data,e.additionalRows);xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.utils.book_append_sheet(a,t,e.sheetName)})),xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.writeFile(a,"".concat(t,".xlsx"))},loadFile=function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){var a=xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.read(n.result,{type:"array"});t(a)},n.onerror=function(e){a(e)},n.readAsArrayBuffer(e)}))},createTableData=function(e){var t,a,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.ref,i=void 0===s?null!==(t=null!==(a=null===e||void 0===e||null===(n=e["!autofilter"])||void 0===n?void 0:n.ref)&&void 0!==a?a:null===e||void 0===e?void 0:e["!ref"])&&void 0!==t?t:"":s,l=r.hasHeader,o=void 0===l||l,c=r.hasBody,u=void 0===c||c;if(!i)return{header:[],body:[]};var d=xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.utils.decode_range(i),h=new Set;e["!merges"]&&e["!merges"].forEach((function(e){for(var t=e.s.r;t<=e.e.r;t++)h.add(t)}));for(var p=new Set,b=d.s.r;b<=d.e.r&&e["A"+(b+1)];b++)h.has(b)||p.add(b+1);for(var m=p.values().next().value,f=new Set,j=d.s.c;j<=d.e.c;j++){var _=xlsx__WEBPACK_IMPORTED_MODULE_5___default.a.utils.encode_col(j);if(!e[_+m])break;f.add(_)}var v=[];if(o){var O,x=Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__.a)(f.values());try{for(x.s();!(O=x.n()).done;){var y=O.value,g=y+m,C=e[g].w+"(".concat(y,")"),w=C.length,N={titleName:C,title:C,key:y,dataIndex:y,width:"calc(".concat((w>=4?w:4)+"em"," + 17px)"),ellipsis:!0};v.push(N)}}catch(B){x.e(B)}finally{x.f()}}var k=[];if(u){var D=p.values();D.next();var S,P=Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__.a)(D);try{for(P.s();!(S=P.n()).done;){var E,I=S.value,M={id:I+""},A=Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_4__.a)(f.values());try{for(A.s();!(E=A.n()).done;){var T,F,L,R=E.value;if("d"===(null===(T=e[R+I])||void 0===T?void 0:T.t))M[R]=e[R+I].v.toLocaleDateString();else M[R]=null!==(F=null===(L=e[R+I])||void 0===L?void 0:L.w)&&void 0!==F?F:""}}catch(B){A.e(B)}finally{A.f()}k.push(M)}}catch(B){P.e(B)}finally{P.f()}}return{header:v,body:k}},generateSheetData=function(e){var t,a,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.SheetNames[0],s=e.Sheets[r],i=null!==(t=null!==(a=null===s||void 0===s||null===(n=s["!autofilter"])||void 0===n?void 0:n.ref)&&void 0!==a?a:null===s||void 0===s?void 0:s["!ref"])&&void 0!==t?t:"";if(!i)return{header:[],body:[]};var l=createTableData(s,{ref:i,hasHeader:!1}),o=l.header,c=l.body;return{header:o,body:c}},getTableDatasFromExcel=function(){var e=Object(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__.a)(E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(t){var a,n;return E_learnspace_excel_report_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Map,t){e.next=3;break}return e.abrupt("return",a);case 3:return e.prev=3,e.next=6,loadFile(t);case 6:(n=e.sent).SheetNames.forEach((function(e){a.set(e,generateSheetData(n,e).body)})),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(3);case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()}},[[563,1,2]]]);