(this["webpackJsonpexcel-report"]=this["webpackJsonpexcel-report"]||[]).push([[0],{218:function(t,e,a){t.exports={"charts-container":"chart_charts-container__3JARh"}},231:function(t,e){},294:function(t,e,a){t.exports={"process-wrapper":"style_process-wrapper__3ARzG"}},296:function(t,e,a){t.exports={"loading-wrapper":"style_loading-wrapper__3Gm8k"}},325:function(t,e,a){},373:function(t,e){},374:function(t,e){},609:function(t,e,a){"use strict";a.r(e);var n=a(8),s=a(0),o=a.n(s),r=a(41),i=a.n(r),l=(a(325),a(326),a(298)),c=a(39),u=(a(291),a(108)),d=(a(228),a(106)),h=a(46),b=(a(364),a(317)),p=(a(109),a(37)),f=a(318),m=a(60),v=a(63),j=a(164),C=a(165),x=a(179),y=a(177),O=(a(366),a(215)),k=a(78),w="toggle-progress",g="set-percent",D="toggle-loading",S=w,N=g,P=D,A=function(t){return{type:w,payload:{show:t}}},H=function(t){return{type:g,payload:{percent:t}}},I=function(t){return{type:D,payload:{loading:t}}},E=a(54),M=a.n(E),B=a(299),_=(a(478),a(128)),F=(a(610),a(146)),T=a(99),z=a(144),L=(a(482),a(219)),R=[{title:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:80,fixed:"left"},{title:"\u57f9\u8bad\u9879\u76ee\u6570",key:"trainProjectCount",dataIndex:"trainProjectCount",ellipsis:!0,width:100},{title:"\u57f9\u8bad\u603b\u4eba\u6b21",key:"trainPersonCount",dataIndex:"trainPersonCount",ellipsis:!0,width:100},{title:"\u7406\u8bba\u57f9\u8bad\u8bfe\u65f6",key:"theoryHours",dataIndex:"theoryHours",ellipsis:!0,width:100},{title:"\u5b9e\u64cd\u57f9\u8bad\u8bfe\u65f6",key:"practiceHours",dataIndex:"practiceHours",ellipsis:!0,width:100}];function K(t){return[{title:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:60,fixed:"left"},{title:"\u57f9\u8bad\u5e08\u4eba\u6570",key:"personCount",dataIndex:"personCount",ellipsis:!0,width:100,render:function(e,a,s){return Object(n.jsx)(L.a,{type:"number",size:"small",min:0,step:1,value:a.personCount,onChange:function(e){var a=+e.target.value,n=Object(v.a)(t.state.tableDataC);n[s].personCount=a,n[s].rate=a?n[s].personCourseCount/a:void 0,n.forEach((function(t,e){})),t.setState({tableDataC:n})}})}},{title:"\u57f9\u8bad\u5e08\u6388\u8bfe\u4eba\u6570",key:"personCourseCount",dataIndex:"personCourseCount",ellipsis:!0,width:100},{title:"\u57f9\u8bad\u5e08\u5229\u7528\u7387",key:"rate",dataIndex:"rate",ellipsis:!0,width:100},{title:"\u603b\u6388\u8bfe\u5b66\u65f6",key:"totalHours",dataIndex:"totalHours",ellipsis:!0,width:100},{title:"\u4eba\u5747\u6388\u8bfe\u5b66\u65f6",key:"averHours",dataIndex:"averHours",ellipsis:!0,width:100}]}var G,J=[{title:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:80,fixed:"left"},{title:"\u8bc4\u4f30\u9879\u76ee\u6570",key:"projectCount",dataIndex:"projectCount",ellipsis:!0,width:100},{title:"\u8bc4\u4f30\u4eba\u6b21",key:"assessCount",dataIndex:"assessCount",ellipsis:!0,width:100},{title:"\u5408\u683c\u7387",key:"passedRate",dataIndex:"passedRate",ellipsis:!0,width:100},{title:"\u901a\u8fc7\u4eba\u6b21",key:"passedCount",dataIndex:"passedCount",ellipsis:!0,width:100},{title:"\u672a\u901a\u8fc7\u4eba\u6b21",key:"failedCount",dataIndex:"failedCount",ellipsis:!0,width:100},{title:"\u7406\u8bba\u9a8c\u6536\u4eba\u6b21",key:"theoryCount",dataIndex:"theoryCount",ellipsis:!0,width:100},{title:"\u5b9e\u64cd\u9a8c\u6536\u4eba\u6b21",key:"trainCount",dataIndex:"trainCount",ellipsis:!0,width:100}],W=a(218),U=a.n(W),V=a(77),X=a.n(V),Y=(a(550),a(578),a(579),a(585),a(596),a(604),a(290),function(t){var e=Object(s.useRef)(null);return Object(s.useEffect)((function(){var a,n;if(e.current){var s=X.a.init(e.current,{},{width:800,height:350}),o=t.markLine?[{type:"line",markLine:{silent:!0,data:[{name:"\u8fbe\u6807\u7ebf",yAxis:null!==(a=t.markLine)&&void 0!==a?a:0}],label:{},lineStyle:{width:2}}}]:[],r={title:{text:null!==(n=t.title)&&void 0!==n?n:"\u8868",textAlign:"center",left:"50%"},legend:{top:30,formatter:function(e){var a,n;return null!==(a=null===(n=t.dimensions.find((function(t){return t.key===e})))||void 0===n?void 0:n.label)&&void 0!==a?a:""}},grid:{bottom:30},xAxis:{type:"category"},yAxis:{type:"value"},dataset:{dimensions:t.dimensions.map((function(t){return t.key})),source:t.data},series:[].concat(Object(v.a)(Array(t.dimensions.length-1).fill({type:"line"})),o)};return s.setOption(r),function(){s.dispose()}}}),[t.data]),Object(n.jsx)("div",{className:U.a["charts-container"],children:Object(n.jsx)("canvas",{className:U.a.chart,ref:e})})}),q=function(t){Object(x.a)(a,t);var e=Object(y.a)(a);function a(t){var s,o;return Object(j.a)(this,a),(s=e.call(this,t)).idCount=Date.now(),s.handleCalcPatr1=function(){var t=new Set;s.props.outerData.forEach((function(e){return t.add(e[s.state.filters.table1])}));var e,a=[],n=Object(m.a)(t.values());try{for(n.s();!(e=n.n()).done;){var o=e.value;a.push({label:o,value:o})}}catch(c){n.e(c)}finally{n.f()}var r=[],i=[],l=[];[{value:void 0}].concat(a).forEach((function(t){var e=t.value,a=s.calcDataA(e),n=s.calcDataB(e),o=s.calcDataC(e);r.push.apply(r,Object(v.a)(a)),i.push.apply(i,Object(v.a)(n)),l.push.apply(l,Object(v.a)(o))})),s.setState({tableDataA:[].concat(r),tableDataB:[].concat(i),tableDataC:[].concat(l)})},s.handleCalcPatr2=function(){var t=new Set;s.props.outerData.forEach((function(e){return t.add(e[s.state.filters.table2])}));var e,a=[],n=Object(m.a)(t.values());try{for(n.s();!(e=n.n()).done;){var o=e.value;a.push({label:o,value:o})}}catch(i){n.e(i)}finally{n.f()}var r=[];[{value:void 0}].concat(a).forEach((function(t){var e=t.value,a=s.calcDataD(e);r.push.apply(r,Object(v.a)(a))})),s.setState({tableDataD:[].concat(r)})},s.handleExportPart1=function(t){var e=null!==t&&void 0!==t?t:M.a.utils.book_new(),a=s.getExportSheet(s.state.tableColumnsA,s.state.tableDataA);M.a.utils.book_append_sheet(e,a,"\u6838\u5fc3\u6280\u80fd\u60c5\u51b5\u8868");var n=s.getExportSheet(s.state.tableColumnsB,s.state.tableDataB);M.a.utils.book_append_sheet(e,n,"\u57f9\u8bad\u57fa\u672c\u60c5\u51b5\u8868");var o=s.getExportSheet(s.state.tableColumnsC,s.state.tableDataC);M.a.utils.book_append_sheet(e,o,"\u57f9\u8bad\u5e08\u60c5\u51b5\u8868"),!t&&M.a.writeFile(e,"\u57f9\u8bad\u60c5\u51b5\u5206\u6790\u7ed3\u679c.xlsx")},s.state={tableDataA:[],tableColumnsA:R,tableDataB:[],tableColumnsB:(o=Object(z.a)(s),[{title:"\u5355\u4f4d",key:"unitName",dataIndex:"unitName",ellipsis:!0,width:120,fixed:"left"},{title:"\u5c97\u4f4d",key:"station",dataIndex:"station",ellipsis:!0,width:120,fixed:"left"},{title:"\u6708\u4efd",key:"monthName",dataIndex:"monthName",ellipsis:!0,width:60,fixed:"left"},{title:"\u73b0\u5458\u4eba\u6570",key:"nowPersonCount",dataIndex:"nowPersonCount",ellipsis:!0,width:100,fixed:"left",render:function(t,e,a){return Object(n.jsx)(L.a,{type:"number",size:"small",min:0,step:1,onChange:function(t){var e=+t.target.value,n=Object(v.a)(o.state.tableDataB);n[a].nowPersonCount=e,n[a].averTrainHours=e?n[a].trainHours/e:void 0;var s=n.filter((function(t){return t.type===n[a].type&&t.unitName===n[a].unitName})),r="M"===n[a].type?42:"P"===n[a].type?60:1;s.forEach((function(t,e){var a,s,o,i;t.yearAverHours=0===e?null!==(s=t.averTrainHours)&&void 0!==s?s:0:(null!==(o=t.averTrainHours)&&void 0!==o?o:0)+(null!==(i=n[e-1].yearAverHours)&&void 0!==i?i:0),t.completeRate=(null!==(a=t.yearAverHours)&&void 0!==a?a:0)/r})),o.setState({tableDataB:n})}})}},{title:"\u57f9\u8bad\u8bfe\u65f6",key:"trainHours",dataIndex:"trainHours",ellipsis:!0,width:80},{title:"\u57f9\u8bad\u6761\u6570",key:"trainCount",dataIndex:"trainCount",ellipsis:!0,width:80},{title:"\u57f9\u8bad\u4eba\u6b21",key:"trainPersonCount",dataIndex:"trainPersonCount",ellipsis:!0,width:80},{title:"\u4eba\u5747\u57f9\u8bad\u8bfe\u65f6\uff08\u5c0f\u65f6\uff09",key:"averTrainHours",dataIndex:"averTrainHours",ellipsis:!0,width:120},{title:"\u5e74\u5ea6\u7d2f\u8ba1\u4eba\u5747\u8bfe\u65f6\uff08\u5c0f\u65f6\uff09",key:"yearAverHours",dataIndex:"yearAverHours",ellipsis:!0,width:120},{title:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387",key:"completeRate",dataIndex:"completeRate",ellipsis:!0,width:120}]),tableDataC:[],tableColumnsC:K(Object(z.a)(s)),tableDataD:[],tableColumnsD:J,selectedColumnsMap:{month:"B",project:"H",role:"V",manage:"Y",product:"AA",hours:"AG",totalPersonCount:"AD",theoryHours:"AE",practiceHours:"AF",unitName:"F"},filters:{table1:"G",table2:"H"},currentFilterKeyword:"",filtersOptions:[]},s}return Object(C.a)(a,[{key:"calcDataA",value:function(t){var e=this.state.selectedColumnsMap,a=new Map;this.props.outerData.forEach((function(n){if("\u57f9\u8bad\u5e08"===n[e.role]&&"\u5fc5\u77e5\u5fc5\u4f1a\u57f9\u8bad"===n[e.project]&&(!t||n.G===t)){var s=new Date(n[e.month]).getMonth()+1;if(a.has(s)){var o,r=a.get(s);if(r)r.trainProjectCount+=1,r.trainPersonCount+=+n[e.totalPersonCount],r.theoryHours+=+n[e.theoryHours],r.practiceHours+=+n[e.practiceHours],null===(o=r.remarks)||void 0===o||o.add(n.J)}else a.set(s,{trainProjectCount:1,trainPersonCount:+n[e.totalPersonCount],theoryHours:+n[e.theoryHours],practiceHours:+n[e.practiceHours],unitName:t||n[e.unitName],remarks:new Set([n.J]),isCondition:!!t})}}));var n,s=[],o=Object(m.a)(a.entries());try{for(o.s();!(n=o.n()).done;){var r,i=Object(T.a)(n.value,2),l=i[0],c=i[1];s.push(Object(h.a)(Object(h.a)({id:(this.idCount++).toString()},c),{},{month:l,monthName:l+"\u6708",remarksText:Array.from(null!==(r=c.remarks)&&void 0!==r?r:[]).join("\u3001")}))}}catch(u){o.e(u)}finally{o.f()}return s.sort((function(t,e){return t.month-e.month})),!t&&this.setState({tableDataA:s}),s}},{key:"calcDataB",value:function(t){var e=this.state.selectedColumnsMap,a=new Map;this.props.outerData.forEach((function(n){if("\u57f9\u8bad\u5e08"===n[e.role]&&(!t||n.G===t)){var s=new Date(n[e.month]).getMonth()+1,o=+n[e.manage],r=+n[e.product];if(o>0){var i=s+"M";if(a.has(i)){var l=a.get(i);l&&(l.trainCount+=1,l.trainHours+=o*+n[e.hours],l.trainPersonCount+=o)}else a.set(i,{type:"M",station:"\u7ba1\u7406\u548c\u4e1a\u52a1\u6280\u672f",month:s,trainCount:1,trainHours:o*+n[e.hours],trainPersonCount:o,unitName:t||n[e.unitName],isCondition:!!t})}if(r>0){var c=s+"P";if(a.has(c)){var u=a.get(c);u&&(u.trainCount+=1,u.trainHours+=r*+n[e.hours],u.trainPersonCount+=r)}else a.set(c,{type:"P",station:"\u751f\u4ea7\u4eba\u5458",month:s,trainCount:1,trainHours:r*+n[e.hours],trainPersonCount:r,unitName:t||n[e.unitName],isCondition:!!t})}}}));var n,s=[],o=Object(m.a)(a.entries());try{for(o.s();!(n=o.n()).done;){var r=Object(T.a)(n.value,2),i=(r[0],r[1]);s.push(Object(h.a)(Object(h.a)({id:(this.idCount++).toString()},i),{},{monthName:i.month+"\u6708"}))}}catch(l){o.e(l)}finally{o.f()}return s.sort((function(t,e){var a=t.type.charCodeAt(0)-e.type.charCodeAt(0);return 0===a?t.month-e.month:a})),!t&&this.setState({tableDataB:s}),s}},{key:"calcDataC",value:function(t){var e=this.state.selectedColumnsMap,a=new Map,n=new Set(["\u89c1\u4e60","\u4e00\u661f","\u4e8c\u661f","\u4e09\u661f","\u56db\u661f","\u4e94\u661f"]),s=new Set;this.props.outerData.forEach((function(o){if(n.has(o.W)&&(!t||o.G===t)){var r=new Date(o[e.month]).getMonth()+1,i=(o.T+r).toString();if(s.has(i)){if(a.has(r)){var l=a.get(r);l&&(l.totalHours+=+o[e.hours])}}else if(s.add(i),a.has(r)){var c=a.get(r);c&&(c.personCourseCount+=1,c.totalHours+=+o[e.hours])}else a.set(r,{unitName:t||o[e.unitName],personCourseCount:1,totalHours:+o[e.hours],isCondition:!!t})}}));var o,r=[],i=Object(m.a)(a.entries());try{for(i.s();!(o=i.n()).done;){var l=Object(T.a)(o.value,2),c=l[0],u=l[1];r.push(Object(h.a)(Object(h.a)({id:(this.idCount++).toString()},u),{},{month:+c,averHours:u.totalHours/u.personCourseCount,monthName:c+"\u6708",personCount:7,rate:u.personCourseCount/7}))}}catch(d){i.e(d)}finally{i.f()}return r.sort((function(t,e){return t.month-e.month})),!t&&this.setState({tableDataC:r}),r}},{key:"calcDataD",value:function(t){this.state.selectedColumnsMap;var e=new Map,a=new Set(["\u3010\u6240\u6709\u4e13\u4e1a\u3011\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u5b89\u5168\u7ea2\u7ebf","\u3010\u6240\u6709\u4e13\u4e1a\u3011\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u5e94\u6025\u5904\u7f6e\u7c7b\u901a\u7528\u77e5\u8bc6","\u3010\u7ad9\u53f0\u95e8\u3011\u57fa\u7840\u77e5\u8bc6","\u3010\u7ad9\u53f0\u95e8\u3011\u5b89\u5168\u56de\u8def\u5f02\u5e38\u4e2d\u65ad","\u3010\u7ad9\u53f0\u95e8\u3011\u4fe1\u53f7\u7cfb\u7edf\u65e0\u6cd5\u63a7\u5236\u5c4f\u853d\u95e8\u8054\u52a8\u5f00\u5173","\u3010\u7ad9\u53f0\u95e8\u3011\u6574\u4fa7\u6ed1\u52a8\u95e8\u591a\u7ea7\u65e0\u6cd5\u5f00\u5173","\u3010\u7efc\u5408\u76d1\u63a7\u3011\u57fa\u7840\u77e5\u8bc6","\u3010\u7efc\u5408\u76d1\u63a7\u3011\u7f51\u7edc\u4e2d\u65ad","\u3010\u6d88\u9632\u3011FAS\u4e3b\u673a\u53ca\u5de5\u4f5c\u7ad9","\u3010\u6d88\u9632\u3011\u6c14\u706d","\u3010\u6d88\u9632\u3011\u6c34\u6d88\u9632","\u3010\u6d88\u9632\u3011\u8d77\u706b\u5192\u70df\u3001FAS\u8054\u52a8\u6545\u969c","\u3010\u6d88\u9632\u3011\u533a\u95f4\u3001\u8f66\u7ad9\u6d88\u9632\u7206\u7ba1","\u3010\u6d88\u9632\u3011\u6c14\u706d\u8bef\u55b7","\u3010\u7535\u68af\u3011\u57fa\u7840\u77e5\u8bc6","\u3010\u7535\u68af\u3011\u4e58\u5ba2\u7535\u68af\u56f0\u4eba","\u3010\u7ed9\u6392\u6c34\u3011\u63a7\u5236\u67dc","\u3010\u7ed9\u6392\u6c34\u3011\u6c34\u6cf5","\u3010\u7ed9\u6392\u6c34\u3011\u9632\u6c5b\u5e94\u6025\u8bbe\u5907","\u3010\u7ed9\u6392\u6c34\u3011\u533a\u95f4\u79ef\u6c34","\u3010\u901a\u98ce\u3011\u901a\u98ce\u57fa\u7840\u77e5\u8bc6","\u3010\u901a\u98ce\u3011\u533a\u95f4\u51b7\u5a92\u6c34\u7ba1\u7206\u7ba1","\u3010\u901a\u98ce\u3011\u6d88\u9632\u7cfb\u7edf\u8054\u52a8\u4e2d\u73af\u63a7\u6a21\u5f0f\u65e0\u6cd5\u81ea\u52a8\u6267\u884c","\u3010\u4f4e\u538b\u3011400V\u4f4e\u538b\u5f00\u5173\u67dc","\u3010\u4f4e\u538b\u3011\u667a\u80fd\u7167\u660e\u6a21\u5757","\u3010\u4f4e\u538b\u3011400V\u5355\u6bb5\u5931\u7535\u6bcd\u8054\u672a\u5907\u81ea\u6295","\u3010\u4f4e\u538b\u3011\u7167\u660e\u5927\u9762\u79ef\u5931\u7535","\u3010AFC\u3011\u57fa\u672c\u77e5\u8bc6","\u3010AFC\u3011\u5168\u7ad9\u95f8\u673a\u7d27\u6025\u91ca\u653e"]),n=new Set;this.props.outerData.forEach((function(s){if(a.has(s.K)&&s.J&&(!t||s.H===t)){var o=new Date(s.J).getMonth()+1,r=(s.K+o).toString();if(n.has(r)){if(e.has(o)){var i,l=e.get(o);if(l)l.assessCount+=s.O?1:0,l.passedCount+="\u901a\u8fc7"===s.O?1:0,l.failedCount+="\u4e0d\u901a\u8fc7"===s.O?1:0,l.theoryCount+="\u7406\u8bba"===s.M&&s.O?1:0,l.trainCount+="\u5b9e\u64cd"===s.M&&s.O?1:0,null===(i=l.remarks)||void 0===i||i.add(s.K)}}else if(n.add(r),e.has(o)){var c,u=e.get(o);if(u)u.projectCount+=1,u.assessCount+=s.O?1:0,u.passedCount+="\u901a\u8fc7"===s.O?1:0,u.failedCount+="\u4e0d\u901a\u8fc7"===s.O?1:0,u.theoryCount+="\u7406\u8bba"===s.M&&s.O?1:0,u.trainCount+="\u5b9e\u64cd"===s.M&&s.O?1:0,null===(c=u.remarks)||void 0===c||c.add(s.K)}else e.set(o,{unitName:t||s.G,projectCount:1,assessCount:s.O?1:0,passedCount:"\u901a\u8fc7"===s.O?1:0,failedCount:"\u4e0d\u901a\u8fc7"===s.O?1:0,theoryCount:"\u7406\u8bba"===s.M&&s.O?1:0,trainCount:"\u5b9e\u64cd"===s.M&&s.O?1:0,remarks:new Set([s.K]),isCondition:!!t})}}));var s,o=[],r=Object(m.a)(e.entries());try{for(r.s();!(s=r.n()).done;){var i=Object(T.a)(s.value,2),l=i[0],c=i[1],u=[];if(c.remarks){var d,b=Object(m.a)(c.remarks.values());try{for(b.s();!(d=b.n()).done;){var p=d.value;u.push(p.replace(/\u3010.*\u3011/,""))}}catch(f){b.e(f)}finally{b.f()}}o.push(Object(h.a)(Object(h.a)({id:(this.idCount++).toString()},c),{},{month:+l,monthName:l+"\u6708",passedRate:c.assessCount?c.passedCount/c.assessCount:void 0,remarksText:u.join("\u3001")}))}}catch(f){r.e(f)}finally{r.f()}return o.sort((function(t,e){return t.month-e.month})),!t&&this.setState({tableDataD:o}),o}},{key:"handleExportPart2",value:function(t){var e=null!==t&&void 0!==t?t:M.a.utils.book_new(),a=this.getExportSheet(this.state.tableColumnsD,this.state.tableDataD);M.a.utils.book_append_sheet(e,a,"\u5fc5\u77e5\u5fc5\u4f1a\u8bc4\u4f30\u8868"),!t&&M.a.writeFile(e,"\u5fc5\u77e5\u5fc5\u4f1a\u5206\u6790\u7ed3\u679c.xlsx")}},{key:"handleExportAll",value:function(){var t=M.a.utils.book_new();this.handleExportPart1(t),this.handleExportPart2(t),M.a.writeFile(t,"\u57f9\u8bad\u60c5\u51b5\u3001\u5fc5\u77e5\u5fc5\u4f1a\u5206\u6790\u7ed3\u679c.xlsx")}},{key:"getExportSheet",value:function(t,e){var a=new Map,n=[],s=[];t.forEach((function(t,e){var n,o,r,i=(null!==(n=t.title)&&void 0!==n?n:"").toString();a.set((null!==(o=t.key)&&void 0!==o?o:"").toString(),i),s.push({wpx:Number(null!==(r=t.width)&&void 0!==r?r:100)})})),e.forEach((function(t){var e,s={},o=Object(m.a)(a.entries());try{for(o.s();!(e=o.n()).done;){var r=Object(T.a)(e.value,2),i=r[0];s[r[1]]=t[i]}}catch(l){o.e(l)}finally{o.f()}n.push(s)}));var o=M.a.utils.json_to_sheet(n);return o["!cols"]=s,o}},{key:"render",value:function(){var t=this;return Object(n.jsxs)("div",{className:"workbench-result",children:[Object(n.jsxs)("div",{className:"workbench-result-toolbar",children:[Object(n.jsxs)("div",{className:"workbench-result-btns",children:[Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a,{type:"primary",size:"small",onClick:function(){return t.handleCalcPatr1()},children:"\u5206\u6790\u6708\u5ea6\u57f9\u8bad\u660e\u7ec6\u8868"}),Object(n.jsx)(p.a,{size:"small",onClick:function(){return t.handleExportPart1()},children:"\u5bfc\u51fa"})]}),Object(n.jsxs)(p.a.Group,{children:[Object(n.jsx)(p.a,{type:"primary",size:"small",onClick:function(){return t.handleCalcPatr2()},children:"\u5206\u6790\u5fc5\u77e5\u5fc5\u4f1a\u8bc4\u4f30\u660e\u7ec6\u8868"}),Object(n.jsx)(p.a,{size:"small",onClick:function(){return t.handleExportPart2()},children:"\u5bfc\u51fa"})]}),Object(n.jsx)(p.a,{size:"small",onClick:function(){return t.handleExportAll()},children:"\u6574\u5408\u5bfc\u51fa"})]}),Object(n.jsx)("div",{className:"workbench-result-config"})]}),Object(n.jsx)("div",{className:"workbench-result-tables",children:Object(n.jsxs)(_.a,{defaultActiveKey:"1",tabBarStyle:{padding:"0 10px"},style:{height:"100%"},children:[Object(n.jsxs)(_.a.TabPane,{tab:"\u57f9\u8bad-\u6280\u80fd\u8868",children:[Object(n.jsx)(u.a,{columns:this.state.tableColumnsA,dataSource:this.state.tableDataA,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(n.jsx)(Y,{columns:this.state.tableColumnsA,data:this.state.tableDataA.filter((function(t){return!t.isCondition})),title:"\u6280\u80fd\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"trainProjectCount",label:"\u57f9\u8bad\u9879\u76ee\u6570"},{key:"trainPersonCount",label:"\u57f9\u8bad\u603b\u4eba\u6b21"},{key:"theoryHours",label:"\u7406\u8bba\u57f9\u8bad\u8bfe\u65f6"},{key:"practiceHours",label:"\u5b9e\u64cd\u57f9\u8bad\u8bfe\u65f6"}]}),Object(n.jsx)(F.b,{size:"small",children:this.state.tableDataA.filter((function(t){return!t.isCondition})).map((function(t){return Object(n.jsx)(F.b.Item,{style:{padding:"5px 10px"},children:"".concat(t.monthName,"\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u57f9\u8bad\u8ba1\u5212\u5b8c\u6210").concat(t.trainPersonCount,"\u4eba\u6b21\uff0c\u5b9e\u9645\u5b8c\u6210").concat(t.trainPersonCount,"\u4eba\u6b21\uff0c\u4e3b\u8981\u5b8c\u6210").concat(t.remarksText,"\u7b49").concat(t.trainProjectCount,"\u4e2a\u6280\u80fd\u9879\u70b9\u7684\u57f9\u8bad\u3002")},t.id)}))})]},"1"),Object(n.jsxs)(_.a.TabPane,{tab:"\u57f9\u8bad-\u60c5\u51b5\u8868",children:[Object(n.jsx)(u.a,{columns:this.state.tableColumnsB,dataSource:this.state.tableDataB,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(n.jsxs)("div",{style:{display:"flex",justifyContent:"center",overflowX:"auto"},children:[Object(n.jsx)(Y,{columns:this.state.tableColumnsB,data:this.state.tableDataB.filter((function(t){return!t.isCondition&&"M"===t.type})),title:"\u7ba1\u7406\u4eba\u5458\u60c5\u51b5\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"completeRate",label:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387"}],markLine:1}),Object(n.jsx)(Y,{columns:this.state.tableColumnsB,data:this.state.tableDataB.filter((function(t){return!t.isCondition&&"P"===t.type})),title:"\u751f\u4ea7\u4eba\u5458\u60c5\u51b5\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"completeRate",label:"\u5e74\u5ea6\u57f9\u8bad\u8bfe\u65f6\u5b8c\u6210\u7387"}],markLine:1})]})]},"2"),Object(n.jsxs)(_.a.TabPane,{tab:"\u57f9\u8bad-\u8bb2\u5e08\u8868",children:[Object(n.jsx)(u.a,{columns:this.state.tableColumnsC,dataSource:this.state.tableDataC,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(n.jsx)(Y,{columns:this.state.tableColumnsC,data:this.state.tableDataC.filter((function(t){return!t.isCondition})),title:"\u8bb2\u5e08\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"rate",label:"\u57f9\u8bad\u5e08\u5229\u7528\u7387"}]})]},"3"),Object(n.jsxs)(_.a.TabPane,{tab:"\u77e5\u4f1a-\u8bc4\u4f30\u8868",children:[Object(n.jsx)(u.a,{columns:this.state.tableColumnsD,dataSource:this.state.tableDataD,size:"small",bordered:!0,rowKey:"id",pagination:!1,scroll:{x:"max-content"}}),Object(n.jsx)(Y,{columns:this.state.tableColumnsD,data:this.state.tableDataD.filter((function(t){return!t.isCondition})),title:"\u8bc4\u4f30\u8868",dimensions:[{key:"monthName",label:"monthName"},{key:"passedRate",label:"\u5408\u683c\u7387"}]}),Object(n.jsx)(F.b,{size:"small",children:this.state.tableDataD.filter((function(t){return!t.isCondition})).map((function(t){var e;return Object(n.jsx)(F.b.Item,{style:{padding:"5px 10px"},children:"".concat(t.monthName,"\u5b8c\u6210\u8bbe\u5907\u7ef4\u4fdd\u5fc5\u77e5\u5fc5\u4f1a\u9a8c\u6536\u8bc4\u5b9a").concat(t.assessCount,"\u4eba\uff0c\u5b9e\u9645\u901a\u8fc7").concat(t.passedCount,"\u4eba\uff0c\u901a\u8fc7\u7387\u4e3a").concat((100*(null!==(e=t.passedRate)&&void 0!==e?e:0)).toFixed(2),"%\uff0c\u5176\u4e2d\u7406\u8bba\u9a8c\u6536").concat(t.theoryCount,"\u4eba\uff0c\u5b9e\u64cd\u9a8c\u6536").concat(t.trainCount,"\u4eba\uff0c\u9a8c\u6536\u4e3b\u8981\u6280\u80fd\u9879\u70b9\u4e3a\uff1a").concat(t.remarksText,"\u3002")},t.id)}))})]},"4")]})})]})}}]),a}(o.a.Component),Q=a(216),Z=a.n(Q),$=a(301),tt="/test/test-file.xlsx",et=O.a.Content,at={accept:".xlsx, .xls"},nt=function(t){Object(x.a)(a,t);var e=Object(y.a)(a);function a(t){var n;return Object(j.a)(this,a),(n=e.call(this,t)).workbook=null,n.sheetsWrapper=o.a.createRef(),n.sheetScroll=null,n.tableColumnsCaches={},n.tableDataCaches={},n.tableColumnsMapCaches={},n.handleBeforeUpload=function(t,e){return!1},n.uploadOnChange=function(t){var e=t.fileList.slice(-1);n.setState({fileList:e}),0===e.length?n.clearFile():n.loadFile(e[0].originFileObj)},n.loadFile=function(t){if(t){var e=new FileReader;e.onloadstart=function(t){n.props.toggleLoading(!0)},e.onloadend=function(t){n.props.toggleLoading(!1)},e.onload=function(t){n.workbook=M.a.read(e.result,{type:"array"}),n.setState({sheetNames:Object(v.a)(n.workbook.SheetNames),currentSheet:n.workbook.SheetNames.length?n.workbook.SheetNames[0]:""}),window.workbook=n.workbook},e.readAsArrayBuffer(t)}},n.clearFile=function(){n.tableColumnsCaches={},n.tableDataCaches={},n.tableColumnsMapCaches={},n.setState({tableColumns:[],tableData:[],sheetNames:[],currentSheet:"",fileList:[]})},n.handleSheetChange=function(t){n.setState({currentSheet:t.target.value}),n.switchSheet(t.target.value)},n.state={fileList:[],sheetNames:[],currentSheet:"",tableData:[],tableColumns:[],allTableData:[]},n}return Object(C.a)(a,[{key:"switchSheet",value:function(t){var e,a,n;if(this.workbook){var s=this.workbook.Sheets[t],o=null!==(e=null!==(a=null===s||void 0===s||null===(n=s["!autofilter"])||void 0===n?void 0:n.ref)&&void 0!==a?a:null===s||void 0===s?void 0:s["!ref"])&&void 0!==e?e:"";if(o)if(t in this.tableColumnsCaches)this.setState({tableColumns:this.tableColumnsCaches[t],tableData:this.tableDataCaches[t].slice(0,20),allTableData:this.tableDataCaches[t]});else{var r=M.a.utils.decode_range(o),i=new Set;s["!merges"]&&s["!merges"].forEach((function(t){for(var e=t.s.r;e<=t.e.r;e++)i.add(e)}));for(var l=new Set,c=r.s.r;c<=r.e.r&&s["A"+(c+1)];c++)i.has(c)||l.add(c+1);for(var u=l.values().next().value,d=new Set,h=r.s.c;h<=r.e.c;h++){var b=M.a.utils.encode_col(h);if(!s[b+u])break;d.add(b)}var p,f=[],v=new Map,j=Object(m.a)(d.values());try{for(j.s();!(p=j.n()).done;){var C=p.value,x=s[C+u].w+"(".concat(C,")"),y=x.length,O={title:x,key:C,dataIndex:C,width:"calc(".concat((y>=4?y:4)+"em"," + 17px)"),ellipsis:!0};f.push(O),v.set(C,O)}}catch(_){j.e(_)}finally{j.f()}var k=[],w=l.values();w.next();var g,D=Object(m.a)(w);try{for(D.s();!(g=D.n()).done;){var S,N=g.value,P={id:N+""},A=Object(m.a)(d.values());try{for(A.s();!(S=A.n()).done;){var H,I,E,B=S.value;if("d"===(null===(H=s[B+N])||void 0===H?void 0:H.t))P[B]=s[B+N].v.toLocaleDateString();else P[B]=null!==(I=null===(E=s[B+N])||void 0===E?void 0:E.w)&&void 0!==I?I:""}}catch(_){A.e(_)}finally{A.f()}k.push(P)}}catch(_){D.e(_)}finally{D.f()}this.tableColumnsCaches[t]=f,this.tableDataCaches[t]=k,this.tableColumnsMapCaches[t]=v,this.setState({tableColumns:f,tableData:k.slice(0,20),allTableData:k})}else this.setState({tableColumns:[]})}}},{key:"componentDidMount",value:function(){this.sheetsWrapper.current&&(this.sheetScroll=new B.a(this.sheetsWrapper.current,{scrollX:!0,scrollY:!0,click:!0,bounce:!1})),this.test()}},{key:"componentDidUpdate",value:function(t,e){this.state.sheetNames!==e.sheetNames&&this.sheetScroll&&(this.sheetScroll.refresh(),this.switchSheet(this.state.currentSheet))}},{key:"test",value:function(t){var e=this;(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt;return new Promise(function(){var e=Object($.a)(Z.a.mark((function e(a,n){var s,o;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.fetch(t);case 3:if(!((s=e.sent).status>=200&&s.status<300)){e.next=11;break}return e.next=7,s.blob();case 7:o=e.sent,a(o),e.next=12;break;case 11:n(new Error("fetch file error !"));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),n(new Error("get file error !"));case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,a){return e.apply(this,arguments)}}())})(t).then((function(t){e.loadFile(t)})).catch((function(t){return console.log(t)}))}},{key:"render",value:function(){this.tableColumnsMapCaches[this.state.currentSheet];return Object(n.jsx)(O.a,{className:"workbench",children:Object(n.jsxs)(et,{className:"workbench-content",children:[Object(n.jsxs)("div",{className:"workbench-operation",children:[Object(n.jsx)("div",{className:"workbench-operation-left",children:Object(n.jsx)(b.a,Object(h.a)(Object(h.a)({},at),{},{fileList:this.state.fileList,beforeUpload:this.handleBeforeUpload,onChange:this.uploadOnChange,children:Object(n.jsx)(p.a,{size:"small",icon:Object(n.jsx)(f.a,{}),children:"\u9009\u62e9\u672c\u5730\u6587\u4ef6"})}))}),Object(n.jsx)("div",{className:"workbench-operation-right",children:Object(n.jsx)("div",{className:"sheets",ref:this.sheetsWrapper,children:Object(n.jsx)(d.a.Group,{size:"small",value:this.state.currentSheet,onChange:this.handleSheetChange,children:this.state.sheetNames.map((function(t,e){return Object(n.jsx)(d.a.Button,{value:t,children:t},t.toString()+e)}))})})})]}),Object(n.jsxs)("div",{className:"workbench-preview",children:[Object(n.jsx)(u.a,{columns:this.state.tableColumns,dataSource:this.state.tableData,size:"small",bordered:!0,scroll:{x:"max-content",y:150},rowKey:"id",pagination:!1,sticky:!0}),Object(n.jsx)(q,{outerColumns:this.state.tableColumns,outerData:this.state.allTableData})]})]})})}}]),a}(o.a.Component),st=Object(k.b)((function(t){return{loading:t.global.loading}}),(function(t){return{toggleLoading:function(e){return t(I(e))}}}))(nt),ot=(a(220),a(176)),rt=a(294),it=a.n(rt);!function(t){t.Normal="normal",t.Exception="exception",t.Active="active",t.Success="success"}(G||(G={}));var lt=function(){var t=Object(k.c)(),e=Object(k.d)((function(t){return t.global.showProgress})),a=Object(k.d)((function(t){return t.global.percent})),o=Object(s.useState)(G.Normal),r=Object(T.a)(o,2),i=r[0],l=r[1];return Object(s.useEffect)((function(){100===a&&i!==G.Success?l(G.Success):100!==a&&i===G.Success&&l(G.Normal)}),[a,i]),100===a&&setTimeout((function(){t(A(!1)),t(H(0))}),1e3),Object(n.jsx)("div",{className:it.a["process-wrapper"],style:{display:e?"":"none"},children:Object(n.jsx)(ot.a,{percent:a,size:"small",status:i})})},ct=(a(184),a(121)),ut=a(296),dt=a.n(ut),ht=function(){var t=Object(k.d)((function(t){return t.global.loading}));return Object(n.jsx)("div",{className:dt.a["loading-wrapper"],style:{display:t?"":"none"},children:Object(n.jsx)(ct.a,{size:"large"})})},bt=function(){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(lt,{}),Object(n.jsx)(ht,{}),Object(n.jsx)(l.a,{children:Object(n.jsxs)(c.d,{children:[Object(n.jsx)(c.b,{path:"/index",exact:!0,component:st}),Object(n.jsx)(c.a,{to:"/index"})]})})]})},pt=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,612)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,o=e.getLCP,r=e.getTTFB;a(t),n(t),s(t),o(t),r(t)}))},ft=a(116),mt={showProgress:!1,percent:0,loading:!1},vt=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case S:return Object(h.a)(Object(h.a)({},e),{},{showProgress:void 0!==a.payload.show?a.payload.show:!e.showProgress});case N:var n=null!==(t=a.payload.percent)&&void 0!==t?t:0;return n=n<0?0:n>100?100:n,Object(h.a)(Object(h.a)({},e),{},{percent:n});case P:return Object(h.a)(Object(h.a)({},e),{},{loading:void 0!==a.payload.loading?a.payload.loading:!e.loading});default:return e}},jt=Object(ft.b)({global:vt}),Ct=Object(ft.c)(jt);i.a.render(Object(n.jsx)(k.a,{store:Ct,children:Object(n.jsx)(bt,{})}),document.getElementById("root")),pt()}},[[609,1,2]]]);