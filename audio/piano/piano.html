<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Piano</title>
  <link rel="stylesheet" href="./style/index.css">
</head>

<body>
  <button id="play">播放</button>
  <div id="piano-keyboard" class="piano-keyboard"></div>

  <script type="module">
    // 52 白色，36 黑色
    import { Piano } from './js/index.js'
    import { NotePlay, Sequence } from './js/music.js'
    window.piano = new Piano()

    document.getElementById('play').onclick = ev => {
      const actx = new AudioContext()
      const song = (base) => [
        // '- q', '- q', '- q', 
        'A4 e', 'B4 e',
        'C5 qe', 'B4 e', 'C5 q', 'E5, q',
        'B4 hq', 'E4 e', 'E4 e',
        'A4 qe', 'G4 e', 'A4 q', 'C5 q',
        'G4 hq', 'E4 q',
        'F4 qe', 'E4 e', 'F4 q', 'C5 q',
        'E4 h', '- e', 'C5 e', 'C5 e', 'C5 e',
        'B4 qe', '#F4 e', 'F4 q', 'B4 q',
        'B4 h', '- q', 'A4 e', 'B4 e',
        'C5 qe', 'B4 e', 'C5 q', 'E5 q',
        'B4 hq', 'E4 e', 'E4 e',
        'A4 qe', 'G4 e', 'A4 q', 'C5 q',
        'G4 hq', 'D4 e', 'E4 e',
        'F4 q', 'C5 e', 'B4 e', 'B4 e', 'C5 e', 'C5 q',
        'D5 e', 'D5 e', 'E5 e', 'C5 e', 'C5 h',
        'C5 e', 'B4 e', 'A4 e', 'A4 e', 'B4 q', '#G4 q',
        'A4 hq', 'C5 e', 'D5 e',
        'E5 qe', 'D5 e', 'E5 q', 'G5 q',
        'D5 hq', 'G4 e', 'G4 e',
        'C5 qe', 'B4 e', 'C5 q', 'E5 q',
        'E5 w',
        'A4 e', 'B4 e', 'C5 eq', 'B4 q', 'D5 e', 'D5 e',
        'C5 qe', 'G4 e', 'G4 h',
        'F5 q', 'E5 q', 'D5 q', 'C5 q',
        'E5 hq', 'E5 q',
        'A5 h', 'G5 q', 'G5 q',
        'E5 e', 'D5 e', 'C5 h', '- e', 'C5 e',
        'D5 q', 'C5 e', 'D5 e', 'D5 q', 'G5 q',
        'E5 hq', 'E5 q',
        'A5 h', 'G5 h',
        'E5 e', 'D5 e', 'C5 h', '- e', 'C5 e',
        'D5 q', 'C5 e', 'D5 e', 'D5 q', 'B4 q',
        'A4 hq', // 'A4 e', 'B4 e'
      ]
      const seq = new Sequence(actx, song(), { loop: true, tempo: 60, waveType: 'triangle', tone: 'D' })
      seq.play()
    }
  </script>
</body>

</html>